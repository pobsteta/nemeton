% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{smart_map}
\alias{smart_map}
\title{Smart Map with Adaptive Parallelization}
\usage{
smart_map(
  x,
  fn,
  ...,
  threshold = 200L,
  workers = NULL,
  progress = NULL,
  .type = "list"
)
}
\arguments{
\item{x}{A list or vector to iterate over.}

\item{fn}{Function to apply to each element.}

\item{...}{Additional arguments passed to `fn`.}

\item{threshold}{Integer. Minimum number of elements to trigger parallel
execution. Default is 200. For complex operations (e.g., spatial joins,
WFS queries), use lower values (50-100). For simple operations (e.g.,
raster extraction), use higher values (500-1000).}

\item{workers}{Integer. Number of parallel workers. Default is
`min(4, parallel::detectCores() - 1)`.}

\item{progress}{Logical. Show progress bar? Default TRUE for n > 50.}

\item{.type}{Character. Return type: "list" (default), "dbl", "chr", "lgl", "int".
Determines the output format and uses appropriate map variant.}
}
\value{
A list or vector (depending on `.type`) of results.
}
\description{
Applies a function over elements with automatic decision between sequential
and parallel execution based on input size. Avoids the overhead of parallel
processing for small datasets where it would be counterproductive.
}
\details{
The function implements a three-tier strategy:
\enumerate{
  \item If n <= threshold OR furrr not available: use purrr (or base lapply)
  \item If n > threshold AND furrr available: use furrr with parallel plan
  \item Falls back gracefully to base R if neither purrr nor furrr available
}

Recommended thresholds by operation type:
\itemize{
  \item Simple extraction (raster values): 500-1000
  \item Geometric operations (buffer, intersection): 200-500
  \item Complex spatial (WFS queries, route calculations): 50-100
  \item Network operations (API calls): 20-50
}
}
\examples{
\dontrun{
# Simple case - will use sequential processing
results <- smart_map(1:50, function(x) x^2)

# Larger dataset - will use parallel if furrr available
results <- smart_map(1:500, complex_function, threshold = 200)

# Return numeric vector
values <- smart_map(parcels_list, extract_value, .type = "dbl")

# Low threshold for expensive operations
results <- smart_map(units, query_wfs, threshold = 50)
}
}
