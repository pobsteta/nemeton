<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Spécification Technique : Package R nemeton • nemeton</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Spécification Technique : Package R nemeton"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">nemeton</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/getting-started_fr.html">Démarrage rapide</a></li>
    <li><a class="dropdown-item" href="articles/indicator-families_fr.html">Familles d'indicateurs (12 familles + radar)</a></li>
    <li><a class="dropdown-item" href="articles/temporal-analysis_fr.html">Analyse temporelle</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="articles/internationalization.html">Internationalisation (i18n)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pascalobstetar/nemeton/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Spécification Technique : Package R nemeton</h1>
      <small class="dont-index">Source: <a href="https://github.com/pascalobstetar/nemeton/blob/main/SPECIFICATION_TECHNIQUE.md" class="external-link"><code>SPECIFICATION_TECHNIQUE.md</code></a></small>
    </div>

<div id="spécification-technique--package-r-nemeton" class="section level1">

<p><strong>Version</strong> : 1.0.0 <strong>Date</strong> : 2026-01-04 <strong>Statut</strong> : Draft <strong>Auteur</strong> : Architecture logicielle</p>
<hr><div class="section level2">
<h2 id="table-des-matières">Table des matières<a class="anchor" aria-label="anchor" href="#table-des-mati%C3%A8res"></a></h2>
<ol style="list-style-type: decimal"><li><a href="#id_1-vue-densemble">Vue d’ensemble</a></li>
<li><a href="#id_2-p%C3%A9rim%C3%A8tre-fonctionnel">Périmètre fonctionnel</a></li>
<li><a href="#id_3-architecture-du-package">Architecture du package</a></li>
<li><a href="#id_4-design-de-lapi">Design de l’API</a></li>
<li><a href="#id_5-modules-et-responsabilit%C3%A9s">Modules et responsabilités</a></li>
<li><a href="#id_6-catalogue-des-fonctions">Catalogue des fonctions</a></li>
<li><a href="#id_7-structures-de-donn%C3%A9es">Structures de données</a></li>
<li><a href="#id_8-d%C3%A9pendances">Dépendances</a></li>
<li><a href="#id_9-strat%C3%A9gie-de-tests">Stratégie de tests</a></li>
<li><a href="#id_10-documentation-et-exemples">Documentation et exemples</a></li>
<li><a href="#id_11-extensibilit%C3%A9-et-personnalisation">Extensibilité et personnalisation</a></li>
<li><a href="#id_12-feuille-de-route">Feuille de route</a></li>
</ol><hr></div>
<div class="section level2">
<h2 id="id_1-vue-densemble">1. Vue d’ensemble<a class="anchor" aria-label="anchor" href="#id_1-vue-densemble"></a></h2>
<div class="section level3">
<h3 id="id_11-contexte-et-motivation">1.1 Contexte et motivation<a class="anchor" aria-label="anchor" href="#id_11-contexte-et-motivation"></a></h3>
<p>Le package <strong>nemeton</strong> implémente la méthode Néméton, un cadre systémique d’évaluation forestière qui intègre :</p>
<ul><li>
<strong>Indicateurs biophysiques</strong> : carbone, biodiversité, eau, sol, paysage, risques climatiques</li>
<li>
<strong>Dimensions temporelles</strong> : états historiques, présents et futurs (scénarios prospectifs)</li>
<li>
<strong>Dimensions sociales et symboliques</strong> : usages, gouvernance, patrimoine, perception culturelle</li>
</ul><p>Le package s’adresse aux : - Forestiers et gestionnaires de territoire - Écologues et chercheurs en sciences environnementales - Bureaux d’études et collectivités territoriales - Acteurs de la planification territoriale</p>
</div>
<div class="section level3">
<h3 id="id_12-principes-directeurs">1.2 Principes directeurs<a class="anchor" aria-label="anchor" href="#id_12-principes-directeurs"></a></h3>
<ol style="list-style-type: decimal"><li>
<strong>Open data first</strong> : priorité aux données ouvertes et accessibles</li>
<li>
<strong>Interopérabilité</strong> : compatibilité avec l’écosystème R spatial (sf, terra, stars)</li>
<li>
<strong>Modularité</strong> : séparation claire entre acquisition, calcul, agrégation et visualisation</li>
<li>
<strong>Transparence</strong> : traçabilité des calculs et paramètres explicites</li>
<li>
<strong>Extensibilité</strong> : possibilité d’ajouter de nouveaux indicateurs via fonctions custom</li>
<li>
<strong>Reproductibilité</strong> : intégration avec targets/drake pour pipelines reproductibles</li>
</ol></div>
<div class="section level3">
<h3 id="id_13-objectifs-principaux">1.3 Objectifs principaux<a class="anchor" aria-label="anchor" href="#id_13-objectifs-principaux"></a></h3>
<ul><li>Fournir une API claire et cohérente pour analyser des territoires forestiers selon la méthode Néméton</li>
<li>Automatiser le calcul d’indicateurs spatiaux à partir de sources de données standard</li>
<li>Permettre l’analyse comparative multi-temporelle (passé-présent-futur)</li>
<li>Offrir des visualisations prêtes à l’emploi</li>
<li>Faciliter l’export vers SIG (QGIS, ArcGIS) et formats ouverts</li>
</ul><hr></div>
</div>
<div class="section level2">
<h2 id="id_2-périmètre-fonctionnel">2. Périmètre fonctionnel<a class="anchor" aria-label="anchor" href="#id_2-p%C3%A9rim%C3%A8tre-fonctionnel"></a></h2>
<div class="section level3">
<h3 id="id_21-fonctionnalités-principales-mvp">2.1 Fonctionnalités principales (MVP)<a class="anchor" aria-label="anchor" href="#id_21-fonctionnalit%C3%A9s-principales-mvp"></a></h3>
<div class="section level4">
<h4 id="gestion-des-unités-spatiales">Gestion des unités spatiales<a class="anchor" aria-label="anchor" href="#gestion-des-unit%C3%A9s-spatiales"></a></h4>
<ul><li>Définition d’unités d’analyse (parcelles, îlots, grilles) comme objets <code>sf</code>
</li>
<li>Métadonnées associées (nom du site, époque, système de coordonnées, sources)</li>
<li>Support de géométries polygonales et multi-polygonales</li>
</ul></div>
<div class="section level4">
<h4 id="acquisition-et-préparation-des-données">Acquisition et préparation des données<a class="anchor" aria-label="anchor" href="#acquisition-et-pr%C3%A9paration-des-donn%C3%A9es"></a></h4>
<ul><li>Chargement de rasters (NDVI, MNT, indices climatiques, risques)</li>
<li>Chargement de vecteurs (limites administratives, réseau hydro, Natura 2000, routes)</li>
<li>Harmonisation spatiale (reprojection, découpage, masquage)</li>
<li>Validation et nettoyage basique</li>
</ul></div>
<div class="section level4">
<h4 id="calcul-dindicateurs-néméton">Calcul d’indicateurs Néméton<a class="anchor" aria-label="anchor" href="#calcul-dindicateurs-n%C3%A9m%C3%A9ton"></a></h4>
<ul><li>API pour calculer des indicateurs par unité spatiale</li>
<li>Support de fonctions d’agrégation spatiale (mean, median, sum, sd, etc.)</li>
<li>Calcul à partir de rasters (extraction zonale via exactextractr)</li>
<li>Calcul à partir de vecteurs (overlay, distances, densités)</li>
<li>Indicateurs biophysiques, sociaux, productifs, paysagers</li>
</ul></div>
<div class="section level4">
<h4 id="gestion-multi-temporelle">Gestion multi-temporelle<a class="anchor" aria-label="anchor" href="#gestion-multi-temporelle"></a></h4>
<ul><li>Stockage de plusieurs “états Néméton” (époques/scénarios)</li>
<li>Comparaison d’états (différences, ratios, tendances)</li>
<li>Visualisation de trajectoires temporelles</li>
</ul></div>
<div class="section level4">
<h4 id="normalisation-et-indices-composites">Normalisation et indices composites<a class="anchor" aria-label="anchor" href="#normalisation-et-indices-composites"></a></h4>
<ul><li>Normalisation d’indicateurs (0-100, z-score, quantiles, min-max)</li>
<li>Agrégation en indices thématiques (biodiversité, eau, social, etc.)</li>
<li>Calcul d’un indice global Néméton (paramétrable par poids)</li>
</ul></div>
<div class="section level4">
<h4 id="visualisations">Visualisations<a class="anchor" aria-label="anchor" href="#visualisations"></a></h4>
<ul><li>Cartes thématiques par indicateur (ggplot2 + sf)</li>
<li>Diagrammes radar (profils Néméton)</li>
<li>Comparaisons multi-époques (barres, radars juxtaposés)</li>
<li>Timelines d’évolution</li>
</ul></div>
</div>
<div class="section level3">
<h3 id="id_22-fonctionnalités-secondaires-post-mvp">2.2 Fonctionnalités secondaires (post-MVP)<a class="anchor" aria-label="anchor" href="#id_22-fonctionnalit%C3%A9s-secondaires-post-mvp"></a></h3>
<ul><li>Support de calculs à la volée depuis API externes (Copernicus, IGN Géoservices)</li>
<li>Analyse de sensibilité des indices aux poids</li>
<li>Export de rapports HTML interactifs (Rmarkdown, Quarto)</li>
<li>Intégration avec base de données spatiales (PostGIS)</li>
<li>Support de calculs parallèles (future, parallel)</li>
<li>Interface Shiny pour exploration interactive</li>
</ul></div>
<div class="section level3">
<h3 id="id_23-hors-périmètre">2.3 Hors périmètre<a class="anchor" aria-label="anchor" href="#id_23-hors-p%C3%A9rim%C3%A8tre"></a></h3>
<ul><li>Collecte primaire de données terrain</li>
<li>Modélisation prédictive (machine learning, modèles de croissance)</li>
<li>Optimisation de gestion forestière (programmation linéaire)</li>
<li>Interface graphique desktop (GUI standalone)</li>
</ul><hr></div>
</div>
<div class="section level2">
<h2 id="id_3-architecture-du-package">3. Architecture du package<a class="anchor" aria-label="anchor" href="#id_3-architecture-du-package"></a></h2>
<div class="section level3">
<h3 id="id_31-structure-de-répertoires">3.1 Structure de répertoires<a class="anchor" aria-label="anchor" href="#id_31-structure-de-r%C3%A9pertoires"></a></h3>
<pre><code>nemeton/
├── R/
│   ├── nemeton-package.R          # Documentation du package
│   ├── data-units.R               # Fonctions de gestion des unités
│   ├── data-layers.R              # Fonctions de chargement de couches
│   ├── data-preprocessing.R       # Fonctions de préparation
│   ├── indicators-core.R          # Moteur de calcul d'indicateurs
│   ├── indicators-biophysical.R   # Indicateurs biophysiques
│   ├── indicators-social.R        # Indicateurs sociaux
│   ├── indicators-landscape.R     # Indicateurs paysagers
│   ├── temporal.R                 # Gestion multi-temporelle
│   ├── normalization.R            # Normalisation et agrégation
│   ├── visualization.R            # Visualisations
│   ├── utils.R                    # Utilitaires internes
│   ├── zzz.R                      # Hooks de chargement
│   └── nemeton-class.R            # Définitions S3
├── data/                          # Données d'exemple
│   └── massif_demo.rda            # Exemple de massif forestier
├── data-raw/                      # Scripts de préparation de données
│   └── massif_demo.R
├── inst/
│   ├── extdata/                   # Données externes
│   └── templates/                 # Templates Rmarkdown
├── man/                           # Documentation générée
├── tests/
│   ├── testthat/
│   │   ├── fixtures/              # Données de test
│   │   ├── test-units.R
│   │   ├── test-indicators.R
│   │   ├── test-temporal.R
│   │   └── test-visualization.R
│   └── testthat.R
├── vignettes/
│   ├── intro-nemeton.Rmd          # Introduction
│   ├── workflow-basic.Rmd         # Workflow de base
│   ├── multi-temporal.Rmd         # Analyse temporelle
│   ├── custom-indicators.Rmd      # Indicateurs personnalisés
│   └── integration-targets.Rmd    # Intégration avec targets
├── DESCRIPTION
├── NAMESPACE
├── LICENSE
├── README.md
└── NEWS.md</code></pre>
</div>
<div class="section level3">
<h3 id="id_32-paradigme-de-programmation">3.2 Paradigme de programmation<a class="anchor" aria-label="anchor" href="#id_32-paradigme-de-programmation"></a></h3>
<ul><li>
<strong>Programmation fonctionnelle</strong> : fonctions pures autant que possible</li>
<li>
<strong>Classes S3</strong> : pour les objets nemeton (simplicité, compatibilité tidyverse)</li>
<li>
<strong>Pipe-friendly</strong> : fonctions compatibles avec <code>%&gt;%</code> et <code>|&gt;</code>
</li>
<li>
<strong>Tidy evaluation</strong> : utilisation de rlang pour NSE quand nécessaire</li>
</ul></div>
<div class="section level3">
<h3 id="id_33-principes-de-conception">3.3 Principes de conception<a class="anchor" aria-label="anchor" href="#id_33-principes-de-conception"></a></h3>
<ol style="list-style-type: decimal"><li>
<strong>Séparation des responsabilités</strong> : chaque module a un rôle clair</li>
<li>
<strong>Composition</strong> : fonctions de haut niveau composent des fonctions de bas niveau</li>
<li>
<strong>Validation précoce</strong> : vérification des inputs dès l’entrée de fonction</li>
<li>
<strong>Messages informatifs</strong> : warnings et errors explicites</li>
<li>
<strong>Traçabilité</strong> : metadata tracking pour les opérations</li>
</ol><hr></div>
</div>
<div class="section level2">
<h2 id="id_4-design-de-lapi">4. Design de l’API<a class="anchor" aria-label="anchor" href="#id_4-design-de-lapi"></a></h2>
<div class="section level3">
<h3 id="id_41-philosophie-de-lapi">4.1 Philosophie de l’API<a class="anchor" aria-label="anchor" href="#id_41-philosophie-de-lapi"></a></h3>
<p>L’API suit un workflow en 5 étapes :</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Définir les unités d'analyse</span></span>
<span><span class="va">units</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_units.html">nemeton_units</a></span><span class="op">(</span><span class="va">polygons</span>, metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>site <span class="op">=</span> <span class="st">"Massif XYZ"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Charger et préparer les couches spatiales</span></span>
<span><span class="va">layers</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_layers.html">nemeton_layers</a></span><span class="op">(</span></span>
<span>  rasters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ndvi <span class="op">=</span> <span class="st">"ndvi.tif"</span>, dem <span class="op">=</span> <span class="st">"dem.tif"</span><span class="op">)</span>,</span>
<span>  vectors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>hydro <span class="op">=</span> <span class="st">"rivers.gpkg"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Calculer les indicateurs</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_compute.html">nemeton_compute</a></span><span class="op">(</span></span>
<span>  units <span class="op">=</span> <span class="va">units</span>,</span>
<span>  layers <span class="op">=</span> <span class="va">layers</span>,</span>
<span>  indicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"carbon"</span>, <span class="st">"biodiversity"</span>, <span class="st">"water"</span>, <span class="st">"landscape"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 4. Normaliser et agréger en indices</span></span>
<span><span class="va">indices</span> <span class="op">&lt;-</span> <span class="fu">nemeton_index</span><span class="op">(</span><span class="va">results</span>, method <span class="op">=</span> <span class="st">"weighted"</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 5. Visualiser</span></span>
<span><span class="fu">nemeton_map</span><span class="op">(</span><span class="va">results</span>, indicator <span class="op">=</span> <span class="st">"carbon"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/nemeton_radar.html">nemeton_radar</a></span><span class="op">(</span><span class="va">results</span>, unit_id <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_42-workflow-multi-temporel">4.2 Workflow multi-temporel<a class="anchor" aria-label="anchor" href="#id_42-workflow-multi-temporel"></a></h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Créer un projet multi-époques</span></span>
<span><span class="va">project</span> <span class="op">&lt;-</span> <span class="fu">nemeton_project</span><span class="op">(</span></span>
<span>  units <span class="op">=</span> <span class="va">forest_units</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"Forêt de Fontainebleau"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ajouter plusieurs états</span></span>
<span><span class="va">project</span> <span class="op">&lt;-</span> <span class="va">project</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_epoch</span><span class="op">(</span><span class="st">"1950"</span>, layers <span class="op">=</span> <span class="va">layers_1950</span>, indicators <span class="op">=</span> <span class="va">all_indicators</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_epoch</span><span class="op">(</span><span class="st">"2020"</span>, layers <span class="op">=</span> <span class="va">layers_2020</span>, indicators <span class="op">=</span> <span class="va">all_indicators</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_epoch</span><span class="op">(</span><span class="st">"2050_RCP45"</span>, layers <span class="op">=</span> <span class="va">layers_2050</span>, indicators <span class="op">=</span> <span class="va">all_indicators</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Comparer</span></span>
<span><span class="va">changes</span> <span class="op">&lt;-</span> <span class="fu">nemeton_compare</span><span class="op">(</span><span class="va">project</span>, from <span class="op">=</span> <span class="st">"1950"</span>, to <span class="op">=</span> <span class="st">"2020"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualiser</span></span>
<span><span class="fu">nemeton_timeline</span><span class="op">(</span><span class="va">project</span>, indicator <span class="op">=</span> <span class="st">"carbon"</span>, unit_id <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu">nemeton_radar_compare</span><span class="op">(</span><span class="va">project</span>, epochs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1950"</span>, <span class="st">"2020"</span>, <span class="st">"2050_RCP45"</span><span class="op">)</span>, unit_id <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_43-personnalisation-dindicateurs">4.3 Personnalisation d’indicateurs<a class="anchor" aria-label="anchor" href="#id_43-personnalisation-dindicateurs"></a></h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Définir un indicateur custom</span></span>
<span><span class="va">my_indicator</span> <span class="op">&lt;-</span> <span class="fu">nemeton_indicator</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"fragmentation"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"landscape"</span>,</span>
<span>  fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">units</span>, <span class="va">layers</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Calcul personnalisé</span></span>
<span>    <span class="fu">fragmentation_index</span><span class="op">(</span><span class="va">units</span>, <span class="va">layers</span><span class="op">$</span><span class="va">landcover</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  dependencies <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"landcover"</span><span class="op">)</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"Indice de fragmentation forestière"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># L'utiliser</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_compute.html">nemeton_compute</a></span><span class="op">(</span></span>
<span>  units <span class="op">=</span> <span class="va">units</span>,</span>
<span>  layers <span class="op">=</span> <span class="va">layers</span>,</span>
<span>  indicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">my_indicator</span>, <span class="st">"carbon"</span>, <span class="st">"biodiversity"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="id_5-modules-et-responsabilités">5. Modules et responsabilités<a class="anchor" aria-label="anchor" href="#id_5-modules-et-responsabilit%C3%A9s"></a></h2>
<div class="section level3">
<h3 id="id_51-module--gestion-des-unités-data-unitsr">5.1 Module : Gestion des unités (<code>data-units.R</code>)<a class="anchor" aria-label="anchor" href="#id_51-module--gestion-des-unit%C3%A9s-data-unitsr"></a></h3>
<p><strong>Responsabilité</strong> : Définir, valider et manipuler les unités spatiales d’analyse.</p>
<p><strong>Fonctions principales</strong> : - <code><a href="reference/nemeton_units.html">nemeton_units()</a></code> : créer un objet d’unités Néméton - <code>validate_units()</code> : valider la géométrie et les attributs - <code>units_metadata()</code> : getter/setter de métadonnées - <code>units_transform()</code> : reprojection des unités - <code>units_grid()</code> : générer une grille régulière</p>
<p><strong>Responsabilités</strong> : - Validation des géométries (valid, non-empty, CRS défini) - Ajout d’identifiants uniques si absents - Stockage de métadonnées (site, date, CRS, sources)</p>
</div>
<div class="section level3">
<h3 id="id_52-module--couches-spatiales-data-layersr">5.2 Module : Couches spatiales (<code>data-layers.R</code>)<a class="anchor" aria-label="anchor" href="#id_52-module--couches-spatiales-data-layersr"></a></h3>
<p><strong>Responsabilité</strong> : Charger et référencer les couches spatiales externes.</p>
<p><strong>Fonctions principales</strong> : - <code><a href="reference/nemeton_layers.html">nemeton_layers()</a></code> : créer un catalogue de couches - <code>add_raster()</code> : ajouter un raster - <code>add_vector()</code> : ajouter un vecteur - <code>layers_summary()</code> : résumer les couches disponibles</p>
<p><strong>Responsabilités</strong> : - Chargement lazy (ne charge pas en mémoire tant que non utilisé) - Validation de l’existence des fichiers - Stockage de métadonnées (CRS, résolution, extent)</p>
</div>
<div class="section level3">
<h3 id="id_53-module--prétraitement-data-preprocessingr">5.3 Module : Prétraitement (<code>data-preprocessing.R</code>)<a class="anchor" aria-label="anchor" href="#id_53-module--pr%C3%A9traitement-data-preprocessingr"></a></h3>
<p><strong>Responsabilité</strong> : Harmoniser les couches spatiales avec les unités.</p>
<p><strong>Fonctions principales</strong> : - <code>harmonize_crs()</code> : aligner les CRS - <code>crop_to_units()</code> : découper les couches sur l’extent des unités - <code>mask_to_units()</code> : masquer les rasters - <code>clean_geometries()</code> : nettoyer les géométries invalides</p>
<p><strong>Responsabilités</strong> : - Reprojection automatique si nécessaire - Découpage spatial pour réduire la charge mémoire - Warnings informatifs sur les opérations effectuées</p>
</div>
<div class="section level3">
<h3 id="id_54-module--moteur-dindicateurs-indicators-corer">5.4 Module : Moteur d’indicateurs (<code>indicators-core.R</code>)<a class="anchor" aria-label="anchor" href="#id_54-module--moteur-dindicateurs-indicators-corer"></a></h3>
<p><strong>Responsabilité</strong> : Orchestrer le calcul des indicateurs.</p>
<p><strong>Fonctions principales</strong> : - <code><a href="reference/nemeton_compute.html">nemeton_compute()</a></code> : fonction principale de calcul - <code>compute_indicator()</code> : calculer un indicateur unique - <code>register_indicator()</code> : enregistrer un nouvel indicateur - <code><a href="reference/list_indicators.html">list_indicators()</a></code> : lister les indicateurs disponibles</p>
<p><strong>Responsabilités</strong> : - Dispatcher vers les fonctions de calcul spécifiques - Gestion des dépendances entre indicateurs - Gestion des erreurs et warnings par indicateur - Ajout des résultats aux unités sf</p>
</div>
<div class="section level3">
<h3 id="id_55-module--indicateurs-biophysiques-indicators-biophysicalr">5.5 Module : Indicateurs biophysiques (<code>indicators-biophysical.R</code>)<a class="anchor" aria-label="anchor" href="#id_55-module--indicateurs-biophysiques-indicators-biophysicalr"></a></h3>
<p><strong>Responsabilité</strong> : Calculer les indicateurs biophysiques.</p>
<p><strong>Fonctions</strong> : - <code><a href="reference/indicator_carbon.html">indicator_carbon()</a></code> : stock de carbone (biomasse, sol) - <code><a href="reference/indicator_biodiversity.html">indicator_biodiversity()</a></code> : indices de biodiversité (richesse, Shannon, Simpson) - <code><a href="reference/indicator_water.html">indicator_water()</a></code> : régulation hydrique (TWI, proximité hydro) - <code>indicator_soil()</code> : qualité des sols (érosion, texture) - <code>indicator_climate_risk()</code> : risques climatiques (sécheresse, incendie)</p>
</div>
<div class="section level3">
<h3 id="id_56-module--indicateurs-sociaux-indicators-socialr">5.6 Module : Indicateurs sociaux (<code>indicators-social.R</code>)<a class="anchor" aria-label="anchor" href="#id_56-module--indicateurs-sociaux-indicators-socialr"></a></h3>
<p><strong>Responsabilité</strong> : Calculer les indicateurs sociaux et culturels.</p>
<p><strong>Fonctions</strong> : - <code><a href="reference/indicator_accessibility.html">indicator_accessibility()</a></code> : accessibilité (distance aux routes, sentiers) - <code>indicator_protection()</code> : niveau de protection (Natura 2000, etc.) - <code>indicator_usage()</code> : intensité d’usage (densité sentiers, équipements) - <code>indicator_heritage()</code> : valeur patrimoniale (sites classés, arbres remarquables)</p>
</div>
<div class="section level3">
<h3 id="id_57-module--indicateurs-paysagers-indicators-landscaper">5.7 Module : Indicateurs paysagers (<code>indicators-landscape.R</code>)<a class="anchor" aria-label="anchor" href="#id_57-module--indicateurs-paysagers-indicators-landscaper"></a></h3>
<p><strong>Responsabilité</strong> : Calculer les indicateurs de structure paysagère.</p>
<p><strong>Fonctions</strong> : - <code><a href="reference/indicator_fragmentation.html">indicator_fragmentation()</a></code> : fragmentation (patches, connectivité) - <code>indicator_heterogeneity()</code> : hétérogénéité (diversité paysagère) - <code>indicator_naturalness()</code> : degré de naturalité (distance à l’intervention humaine) - <code>indicator_continuity()</code> : continuité forestière (taille des massifs)</p>
</div>
<div class="section level3">
<h3 id="id_58-module--gestion-temporelle-temporalr">5.8 Module : Gestion temporelle (<code>temporal.R</code>)<a class="anchor" aria-label="anchor" href="#id_58-module--gestion-temporelle-temporalr"></a></h3>
<p><strong>Responsabilité</strong> : Gérer les analyses multi-temporelles.</p>
<p><strong>Fonctions principales</strong> : - <code>nemeton_project()</code> : créer un projet multi-époques - <code>add_epoch()</code> : ajouter un état temporel - <code>remove_epoch()</code> : supprimer un état - <code>list_epochs()</code> : lister les époques - <code>nemeton_compare()</code> : comparer deux états - <code>compute_trends()</code> : calculer les tendances</p>
<p><strong>Responsabilités</strong> : - Stockage cohérent des états multiples - Validation de la compatibilité des unités entre époques - Calcul de différences, ratios, taux de changement</p>
</div>
<div class="section level3">
<h3 id="id_59-module--normalisation-et-agrégation-normalizationr">5.9 Module : Normalisation et agrégation (<code>normalization.R</code>)<a class="anchor" aria-label="anchor" href="#id_59-module--normalisation-et-agr%C3%A9gation-normalizationr"></a></h3>
<p><strong>Responsabilité</strong> : Normaliser et agréger les indicateurs.</p>
<p><strong>Fonctions principales</strong> : - <code><a href="reference/normalize_indicators.html">normalize_indicators()</a></code> : normaliser (0-100, z-score, quantiles) - <code>nemeton_index()</code> : calculer des indices composites - <code>weight_indicators()</code> : définir des poids - <code>aggregate_thematic()</code> : agréger par thème</p>
<p><strong>Responsabilités</strong> : - Gestion de la polarité (plus c’est haut, mieux c’est ?) - Support de différentes méthodes de normalisation - Agrégation paramétrable (moyenne pondérée, géométrique, min/max)</p>
</div>
<div class="section level3">
<h3 id="id_510-module--visualisation-visualizationr">5.10 Module : Visualisation (<code>visualization.R</code>)<a class="anchor" aria-label="anchor" href="#id_510-module--visualisation-visualizationr"></a></h3>
<p><strong>Responsabilité</strong> : Générer des visualisations prêtes à l’emploi.</p>
<p><strong>Fonctions principales</strong> : - <code>nemeton_map()</code> : carte thématique d’un indicateur - <code><a href="reference/nemeton_radar.html">nemeton_radar()</a></code> : diagramme radar pour une unité - <code>nemeton_timeline()</code> : évolution temporelle - <code>nemeton_radar_compare()</code> : radars multi-époques - <code>nemeton_matrix()</code> : heatmap de corrélation d’indicateurs</p>
<p><strong>Responsabilités</strong> : - Génération de ggplot2 personnalisables - Palettes de couleurs adaptées (viridis, RColorBrewer) - Légendes et titres informatifs - Export facile (ggsave compatible)</p>
</div>
<div class="section level3">
<h3 id="id_511-module--utilitaires-utilsr">5.11 Module : Utilitaires (<code>utils.R</code>)<a class="anchor" aria-label="anchor" href="#id_511-module--utilitaires-utilsr"></a></h3>
<p><strong>Responsabilité</strong> : Fonctions utilitaires internes.</p>
<p><strong>Fonctions</strong> : - <code>check_crs()</code> : vérifier compatibilité CRS - <code>validate_sf()</code> : valider objet sf - <code>validate_raster()</code> : valider objet SpatRaster - <code>message_nemeton()</code> : messages formatés - <code>progress_bar()</code> : barre de progression optionnelle</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="id_6-catalogue-des-fonctions">6. Catalogue des fonctions<a class="anchor" aria-label="anchor" href="#id_6-catalogue-des-fonctions"></a></h2>
<div class="section level3">
<h3 id="id_61-fonctions-de-haut-niveau-high-level-api">6.1 Fonctions de haut niveau (High-level API)<a class="anchor" aria-label="anchor" href="#id_61-fonctions-de-haut-niveau-high-level-api"></a></h3>
<div class="section level4">
<h4 id="nemeton_units"><code>nemeton_units()</code><a class="anchor" aria-label="anchor" href="#nemeton_units"></a></h4>
<p><strong>Signature</strong> :</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/nemeton_units.html">nemeton_units</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  id_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  validate <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Arguments</strong> : - <code>x</code> : objet sf, ou chemin vers shapefile/geopackage - <code>id_col</code> : nom de la colonne d’identifiant (créée si NULL) - <code>metadata</code> : liste nommée de métadonnées - <code>validate</code> : valider les géométries ?</p>
<p><strong>Retour</strong> : objet <code>nemeton_units</code> (hérite de <code>sf</code>)</p>
<p><strong>Exemple</strong> :</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">units</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_units.html">nemeton_units</a></span><span class="op">(</span></span>
<span>  <span class="fu">st_read</span><span class="op">(</span><span class="st">"parcelles.gpkg"</span><span class="op">)</span>,</span>
<span>  metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>site <span class="op">=</span> <span class="st">"Forêt de Compiègne"</span>, year <span class="op">=</span> <span class="fl">2024</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr></div>
<div class="section level4">
<h4 id="nemeton_layers"><code>nemeton_layers()</code><a class="anchor" aria-label="anchor" href="#nemeton_layers"></a></h4>
<p><strong>Signature</strong> :</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/nemeton_layers.html">nemeton_layers</a></span><span class="op">(</span></span>
<span>  rasters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vectors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  validate <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Arguments</strong> : - <code>rasters</code> : liste nommée de chemins vers rasters - <code>vectors</code> : liste nommée de chemins vers vecteurs - <code>validate</code> : vérifier l’existence des fichiers ?</p>
<p><strong>Retour</strong> : objet <code>nemeton_layers</code> (liste S3)</p>
<p><strong>Exemple</strong> :</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">layers</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_layers.html">nemeton_layers</a></span><span class="op">(</span></span>
<span>  rasters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    ndvi <span class="op">=</span> <span class="st">"sentinel2_ndvi.tif"</span>,</span>
<span>    dem <span class="op">=</span> <span class="st">"ign_mnt_25m.tif"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  vectors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    hydro <span class="op">=</span> <span class="st">"bdtopo_hydro.gpkg"</span>,</span>
<span>    roads <span class="op">=</span> <span class="st">"routes.shp"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr></div>
<div class="section level4">
<h4 id="nemeton_compute"><code>nemeton_compute()</code><a class="anchor" aria-label="anchor" href="#nemeton_compute"></a></h4>
<p><strong>Signature</strong> :</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/nemeton_compute.html">nemeton_compute</a></span><span class="op">(</span></span>
<span>  <span class="va">units</span>,</span>
<span>  <span class="va">layers</span>,</span>
<span>  indicators <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  preprocess <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Arguments</strong> : - <code>units</code> : objet nemeton_units - <code>layers</code> : objet nemeton_layers - <code>indicators</code> : vecteur de noms d’indicateurs ou “all” - <code>preprocess</code> : harmoniser automatiquement les CRS/extent ? - <code>parallel</code> : calcul parallèle (future backend) ? - <code>progress</code> : afficher barre de progression ? - <code>...</code> : arguments passés aux fonctions d’indicateurs</p>
<p><strong>Retour</strong> : objet <code>sf</code> avec colonnes d’indicateurs</p>
<p><strong>Exemple</strong> :</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_compute.html">nemeton_compute</a></span><span class="op">(</span></span>
<span>  units <span class="op">=</span> <span class="va">my_units</span>,</span>
<span>  layers <span class="op">=</span> <span class="va">my_layers</span>,</span>
<span>  indicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"carbon"</span>, <span class="st">"biodiversity"</span>, <span class="st">"water"</span><span class="op">)</span>,</span>
<span>  preprocess <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr></div>
<div class="section level4">
<h4 id="nemeton_index"><code>nemeton_index()</code><a class="anchor" aria-label="anchor" href="#nemeton_index"></a></h4>
<p><strong>Signature</strong> :</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nemeton_index</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weighted"</span>, <span class="st">"geometric"</span>, <span class="st">"harmonic"</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  normalize_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"minmax"</span>, <span class="st">"zscore"</span>, <span class="st">"rank"</span><span class="op">)</span>,</span>
<span>  thematic_groups <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Arguments</strong> : - <code>data</code> : sf avec indicateurs calculés - <code>method</code> : méthode d’agrégation - <code>weights</code> : vecteur de poids (NULL = équipondéré) - <code>normalize</code> : normaliser avant agrégation ? - <code>normalize_method</code> : méthode de normalisation - <code>thematic_groups</code> : liste pour indices thématiques</p>
<p><strong>Retour</strong> : <code>sf</code> avec colonnes d’indices</p>
<p><strong>Exemple</strong> :</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indices</span> <span class="op">&lt;-</span> <span class="fu">nemeton_index</span><span class="op">(</span></span>
<span>  <span class="va">results</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"weighted"</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>carbon <span class="op">=</span> <span class="fl">0.3</span>, biodiversity <span class="op">=</span> <span class="fl">0.4</span>, water <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>  thematic_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    ecological <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"biodiversity"</span>, <span class="st">"water"</span><span class="op">)</span>,</span>
<span>    climate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"carbon"</span>, <span class="st">"climate_risk"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr></div>
<div class="section level4">
<h4 id="nemeton_project"><code>nemeton_project()</code><a class="anchor" aria-label="anchor" href="#nemeton_project"></a></h4>
<p><strong>Signature</strong> :</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nemeton_project</span><span class="op">(</span></span>
<span>  <span class="va">units</span>,</span>
<span>  name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  description <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Arguments</strong> : - <code>units</code> : objet nemeton_units (template spatial) - <code>name</code> : nom du projet - <code>description</code> : description optionnelle</p>
<p><strong>Retour</strong> : objet <code>nemeton_project</code> (liste S3)</p>
<p><strong>Exemple</strong> :</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">project</span> <span class="op">&lt;-</span> <span class="fu">nemeton_project</span><span class="op">(</span></span>
<span>  units <span class="op">=</span> <span class="va">forest_units</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"Analyse diachronique Fontainebleau"</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"Comparaison 1950-2020-2050"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr></div>
<div class="section level4">
<h4 id="add_epoch"><code>add_epoch()</code><a class="anchor" aria-label="anchor" href="#add_epoch"></a></h4>
<p><strong>Signature</strong> :</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">add_epoch</span><span class="op">(</span></span>
<span>  <span class="va">project</span>,</span>
<span>  <span class="va">epoch_name</span>,</span>
<span>  layers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  indicators <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  compute <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Arguments</strong> : - <code>project</code> : objet nemeton_project - <code>epoch_name</code> : identifiant de l’époque (ex: “2020”, “scenario_RCP45”) - <code>layers</code> : nemeton_layers pour cette époque - <code>data</code> : ou directement sf avec indicateurs pré-calculés - <code>indicators</code> : indicateurs à calculer - <code>compute</code> : calculer maintenant ou plus tard ? - <code>...</code> : arguments pour nemeton_compute()</p>
<p><strong>Retour</strong> : <code>nemeton_project</code> modifié</p>
<p><strong>Exemple</strong> :</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">project</span> <span class="op">&lt;-</span> <span class="va">project</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_epoch</span><span class="op">(</span><span class="st">"1950"</span>, layers <span class="op">=</span> <span class="va">layers_1950</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_epoch</span><span class="op">(</span><span class="st">"2020"</span>, layers <span class="op">=</span> <span class="va">layers_2020</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_epoch</span><span class="op">(</span><span class="st">"2050"</span>, layers <span class="op">=</span> <span class="va">layers_2050_rcp45</span><span class="op">)</span></span></code></pre></div>
<hr></div>
<div class="section level4">
<h4 id="nemeton_compare"><code>nemeton_compare()</code><a class="anchor" aria-label="anchor" href="#nemeton_compare"></a></h4>
<p><strong>Signature</strong> :</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nemeton_compare</span><span class="op">(</span></span>
<span>  <span class="va">project</span>,</span>
<span>  <span class="va">from</span>,</span>
<span>  <span class="va">to</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"difference"</span>, <span class="st">"ratio"</span>, <span class="st">"percent_change"</span><span class="op">)</span>,</span>
<span>  indicators <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Arguments</strong> : - <code>project</code> : nemeton_project - <code>from</code> : nom de l’époque de référence - <code>to</code> : nom de l’époque de comparaison - <code>method</code> : type de comparaison - <code>indicators</code> : indicateurs à comparer (NULL = tous)</p>
<p><strong>Retour</strong> : <code>sf</code> avec colonnes de changement</p>
<p><strong>Exemple</strong> :</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">changes</span> <span class="op">&lt;-</span> <span class="fu">nemeton_compare</span><span class="op">(</span></span>
<span>  <span class="va">project</span>,</span>
<span>  from <span class="op">=</span> <span class="st">"1950"</span>,</span>
<span>  to <span class="op">=</span> <span class="st">"2020"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"percent_change"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level3">
<h3 id="id_62-fonctions-de-visualisation">6.2 Fonctions de visualisation<a class="anchor" aria-label="anchor" href="#id_62-fonctions-de-visualisation"></a></h3>
<div class="section level4">
<h4 id="nemeton_map"><code>nemeton_map()</code><a class="anchor" aria-label="anchor" href="#nemeton_map"></a></h4>
<p><strong>Signature</strong> :</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nemeton_map</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">indicator</span>,</span>
<span>  palette <span class="op">=</span> <span class="st">"viridis"</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Arguments</strong> : - <code>data</code> : sf avec indicateurs - <code>indicator</code> : nom de l’indicateur à cartographier - <code>palette</code> : palette de couleurs (viridis, RColorBrewer) - <code>title</code> : titre de la carte - <code>breaks</code> : breaks pour les classes (NULL = automatique) - <code>...</code> : arguments passés à geom_sf()</p>
<p><strong>Retour</strong> : objet <code>ggplot</code></p>
<hr></div>
<div class="section level4">
<h4 id="nemeton_radar"><code>nemeton_radar()</code><a class="anchor" aria-label="anchor" href="#nemeton_radar"></a></h4>
<p><strong>Signature</strong> :</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/nemeton_radar.html">nemeton_radar</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  unit_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  indicators <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fill_alpha <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  color <span class="op">=</span> <span class="st">"steelblue"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Arguments</strong> : - <code>data</code> : sf avec indicateurs - <code>unit_id</code> : identifiant de l’unité (NULL = moyenne de toutes) - <code>indicators</code> : indicateurs à afficher (NULL = tous) - <code>normalize</code> : normaliser 0-100 ? - <code>fill_alpha</code> : transparence du remplissage - <code>color</code> : couleur principale</p>
<p><strong>Retour</strong> : objet <code>ggplot</code></p>
<hr></div>
<div class="section level4">
<h4 id="nemeton_timeline"><code>nemeton_timeline()</code><a class="anchor" aria-label="anchor" href="#nemeton_timeline"></a></h4>
<p><strong>Signature</strong> :</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nemeton_timeline</span><span class="op">(</span></span>
<span>  <span class="va">project</span>,</span>
<span>  <span class="va">indicator</span>,</span>
<span>  unit_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"median"</span>, <span class="st">"min"</span>, <span class="st">"max"</span><span class="op">)</span>,</span>
<span>  smooth <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Arguments</strong> : - <code>project</code> : nemeton_project - <code>indicator</code> : indicateur à suivre - <code>unit_id</code> : unité spécifique (NULL = moyenne de toutes) - <code>stat</code> : statistique si unit_id = NULL - <code>smooth</code> : ajouter une courbe lissée ?</p>
<p><strong>Retour</strong> : objet <code>ggplot</code></p>
<hr></div>
<div class="section level4">
<h4 id="nemeton_radar_compare"><code>nemeton_radar_compare()</code><a class="anchor" aria-label="anchor" href="#nemeton_radar_compare"></a></h4>
<p><strong>Signature</strong> :</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nemeton_radar_compare</span><span class="op">(</span></span>
<span>  <span class="va">project</span>,</span>
<span>  <span class="va">epochs</span>,</span>
<span>  <span class="va">unit_id</span>,</span>
<span>  indicators <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  facet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Arguments</strong> : - <code>project</code> : nemeton_project - <code>epochs</code> : vecteur d’époques à comparer - <code>unit_id</code> : identifiant de l’unité - <code>indicators</code> : indicateurs à afficher - <code>facet</code> : afficher en facettes séparées ?</p>
<p><strong>Retour</strong> : objet <code>ggplot</code></p>
<hr></div>
</div>
<div class="section level3">
<h3 id="id_63-fonctions-dindicateurs">6.3 Fonctions d’indicateurs<a class="anchor" aria-label="anchor" href="#id_63-fonctions-dindicateurs"></a></h3>
<p>Toutes les fonctions d’indicateurs suivent cette signature standard :</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>indicator_<span class="sc">&lt;</span>name<span class="sc">&gt;</span>(</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  units,</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  layers,</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"default"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  <span class="at">params =</span> <span class="fu">list</span>(),</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>  <span class="at">fun =</span> <span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"median"</span>, <span class="st">"sum"</span>, <span class="st">"sd"</span>),</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>Retour</strong> : vecteur numérique (même longueur que nrow(units))</p>
<div class="section level4">
<h4 id="exemples">Exemples<a class="anchor" aria-label="anchor" href="#exemples"></a></h4>
<p><strong><code><a href="reference/indicator_carbon.html">indicator_carbon()</a></code></strong></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/indicator_carbon.html">indicator_carbon</a></span><span class="op">(</span></span>
<span>  <span class="va">units</span>,</span>
<span>  <span class="va">layers</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"biomass"</span>, <span class="st">"soil"</span>, <span class="st">"total"</span><span class="op">)</span>,</span>
<span>  biomass_var <span class="op">=</span> <span class="st">"AGB"</span>,  <span class="co"># Above-Ground Biomass</span></span>
<span>  soil_depth <span class="op">=</span> <span class="fl">30</span>,      <span class="co"># cm</span></span>
<span>  fun <span class="op">=</span> <span class="st">"sum"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong><code><a href="reference/indicator_biodiversity.html">indicator_biodiversity()</a></code></strong></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/indicator_biodiversity.html">indicator_biodiversity</a></span><span class="op">(</span></span>
<span>  <span class="va">units</span>,</span>
<span>  <span class="va">layers</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"richness"</span>, <span class="st">"shannon"</span>, <span class="st">"simpson"</span><span class="op">)</span>,</span>
<span>  species_layer <span class="op">=</span> <span class="st">"species_raster"</span>,</span>
<span>  fun <span class="op">=</span> <span class="st">"mean"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong><code><a href="reference/indicator_water.html">indicator_water()</a></code></strong></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/indicator_water.html">indicator_water</a></span><span class="op">(</span></span>
<span>  <span class="va">units</span>,</span>
<span>  <span class="va">layers</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"twi"</span>, <span class="st">"proximity"</span>, <span class="st">"retention"</span><span class="op">)</span>,</span>
<span>  dem_layer <span class="op">=</span> <span class="st">"dem"</span>,</span>
<span>  hydro_layer <span class="op">=</span> <span class="st">"rivers"</span>,</span>
<span>  buffer <span class="op">=</span> <span class="fl">100</span>  <span class="co"># mètres</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong><code><a href="reference/indicator_accessibility.html">indicator_accessibility()</a></code></strong></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/indicator_accessibility.html">indicator_accessibility</a></span><span class="op">(</span></span>
<span>  <span class="va">units</span>,</span>
<span>  <span class="va">layers</span>,</span>
<span>  roads_layer <span class="op">=</span> <span class="st">"roads"</span>,</span>
<span>  trails_layer <span class="op">=</span> <span class="st">"trails"</span>,</span>
<span>  max_distance <span class="op">=</span> <span class="fl">1000</span>,  <span class="co"># mètres</span></span>
<span>  decay_function <span class="op">=</span> <span class="st">"exponential"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level3">
<h3 id="id_64-fonctions-de-normalisation">6.4 Fonctions de normalisation<a class="anchor" aria-label="anchor" href="#id_64-fonctions-de-normalisation"></a></h3>
<div class="section level4">
<h4 id="normalize_indicators"><code>normalize_indicators()</code><a class="anchor" aria-label="anchor" href="#normalize_indicators"></a></h4>
<p><strong>Signature</strong> :</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/normalize_indicators.html">normalize_indicators</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  indicators <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"minmax"</span>, <span class="st">"zscore"</span>, <span class="st">"rank"</span>, <span class="st">"percentile"</span><span class="op">)</span>,</span>
<span>  polarity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Arguments</strong> : - <code>data</code> : sf avec indicateurs - <code>indicators</code> : indicateurs à normaliser (NULL = numériques) - <code>method</code> : méthode de normalisation - <code>polarity</code> : vecteur nommé (+1 ou -1) pour direction souhaitée - <code>range</code> : intervalle cible pour minmax</p>
<p><strong>Retour</strong> : <code>sf</code> avec colonnes normalisées</p>
<p><strong>Exemple</strong> :</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normalized</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/normalize_indicators.html">normalize_indicators</a></span><span class="op">(</span></span>
<span>  <span class="va">results</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"minmax"</span>,</span>
<span>  polarity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>carbon <span class="op">=</span> <span class="fl">1</span>, fragmentation <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,  <span class="co"># fragmentation : moins = mieux</span></span>
<span>  range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level3">
<h3 id="id_65-fonctions-utilitaires">6.5 Fonctions utilitaires<a class="anchor" aria-label="anchor" href="#id_65-fonctions-utilitaires"></a></h3>
<div class="section level4">
<h4 id="harmonize_crs"><code>harmonize_crs()</code><a class="anchor" aria-label="anchor" href="#harmonize_crs"></a></h4>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">harmonize_crs</span><span class="op">(</span><span class="va">layers</span>, <span class="va">target_crs</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="crop_to_units"><code>crop_to_units()</code><a class="anchor" aria-label="anchor" href="#crop_to_units"></a></h4>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">crop_to_units</span><span class="op">(</span><span class="va">layers</span>, <span class="va">units</span>, buffer <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="list_indicators"><code>list_indicators()</code><a class="anchor" aria-label="anchor" href="#list_indicators"></a></h4>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/list_indicators.html">list_indicators</a></span><span class="op">(</span>category <span class="op">=</span> <span class="cn">NULL</span>, return <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"names"</span>, <span class="st">"details"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="register_indicator"><code>register_indicator()</code><a class="anchor" aria-label="anchor" href="#register_indicator"></a></h4>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">register_indicator</span><span class="op">(</span></span>
<span>  <span class="va">name</span>,</span>
<span>  <span class="va">fun</span>,</span>
<span>  category <span class="op">=</span> <span class="st">"custom"</span>,</span>
<span>  dependencies <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  description <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr></div>
</div>
</div>
<div class="section level2">
<h2 id="id_7-structures-de-données">7. Structures de données<a class="anchor" aria-label="anchor" href="#id_7-structures-de-donn%C3%A9es"></a></h2>
<div class="section level3">
<h3 id="id_71-classe-nemeton_units">7.1 Classe <code>nemeton_units</code>
<a class="anchor" aria-label="anchor" href="#id_71-classe-nemeton_units"></a></h3>
<p><strong>Héritage</strong> : <code>sf</code> → <code>data.frame</code></p>
<p><strong>Attributs obligatoires</strong> : - Colonne géométrique (POLYGON ou MULTIPOLYGON) - Colonne <code>nemeton_id</code> (character ou integer unique)</p>
<p><strong>Métadonnées</strong> (attribut <code>metadata</code>) :</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  site_name <span class="op">=</span> <span class="st">"Forêt de ..."</span>,</span>
<span>  year <span class="op">=</span> <span class="fl">2024</span>,</span>
<span>  crs <span class="op">=</span> <span class="fu">st_crs</span><span class="op">(</span><span class="va">units</span><span class="op">)</span>,</span>
<span>  n_units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">units</span><span class="op">)</span>,</span>
<span>  area_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">st_area</span><span class="op">(</span><span class="va">units</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  created_at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"IGN BD Forêt v2"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Méthodes S3</strong> : - <code><a href="reference/print.nemeton_units.html">print.nemeton_units()</a></code> - <code><a href="reference/summary.nemeton_units.html">summary.nemeton_units()</a></code> - <code>plot.nemeton_units()</code></p>
<hr></div>
<div class="section level3">
<h3 id="id_72-classe-nemeton_layers">7.2 Classe <code>nemeton_layers</code>
<a class="anchor" aria-label="anchor" href="#id_72-classe-nemeton_layers"></a></h3>
<p><strong>Structure</strong> : liste nommée</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  rasters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    ndvi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"..."</span>, loaded <span class="op">=</span> <span class="cn">FALSE</span>, metadata <span class="op">=</span> <span class="va">...</span><span class="op">)</span>,</span>
<span>    dem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"..."</span>, loaded <span class="op">=</span> <span class="cn">FALSE</span>, metadata <span class="op">=</span> <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  vectors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    hydro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"..."</span>, loaded <span class="op">=</span> <span class="cn">FALSE</span>, metadata <span class="op">=</span> <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    created_at <span class="op">=</span> <span class="va">...</span>,</span>
<span>    n_rasters <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    n_vectors <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Méthodes S3</strong> : - <code><a href="reference/print.nemeton_layers.html">print.nemeton_layers()</a></code> - <code><a href="reference/summary.nemeton_layers.html">summary.nemeton_layers()</a></code></p>
<hr></div>
<div class="section level3">
<h3 id="id_73-classe-nemeton_project">7.3 Classe <code>nemeton_project</code>
<a class="anchor" aria-label="anchor" href="#id_73-classe-nemeton_project"></a></h3>
<p><strong>Structure</strong> : liste S3</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">"Projet X"</span>,</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>  <span class="at">description =</span> <span class="st">"..."</span>,</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>  <span class="at">units_template =</span> <span class="sc">&lt;</span>nemeton_units<span class="sc">&gt;</span>,  <span class="co"># Template spatial</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>  <span class="at">epochs =</span> <span class="fu">list</span>(</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>    <span class="st">"1950"</span> <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>      <span class="at">layers =</span> <span class="sc">&lt;</span>nemeton_layers<span class="sc">&gt;</span>,</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>      <span class="at">data =</span> <span class="sc">&lt;</span>sf with indicators<span class="sc">&gt;</span>,</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>      <span class="at">computed_at =</span> <span class="sc">&lt;</span>timestamp<span class="sc">&gt;</span>,</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>      <span class="at">metadata =</span> <span class="fu">list</span>(...)</span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>    ),</span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a>    <span class="st">"2020"</span> <span class="ot">=</span> <span class="fu">list</span>(...),</span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a>    <span class="st">"2050_RCP45"</span> <span class="ot">=</span> <span class="fu">list</span>(...)</span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>  ),</span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a>  <span class="at">metadata =</span> <span class="fu">list</span>(</span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a>    <span class="at">created_at =</span> ...,</span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a>    <span class="at">n_epochs =</span> <span class="dv">3</span>,</span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a>    <span class="at">indicators_computed =</span> <span class="fu">c</span>(<span class="st">"carbon"</span>, <span class="st">"biodiversity"</span>, ...),</span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a>    ...</span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a>  )</span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>Méthodes S3</strong> : - <code>print.nemeton_project()</code> - <code>summary.nemeton_project()</code> - <code>plot.nemeton_project()</code></p>
<hr></div>
<div class="section level3">
<h3 id="id_74-classe-nemeton_indicator">7.4 Classe <code>nemeton_indicator</code>
<a class="anchor" aria-label="anchor" href="#id_74-classe-nemeton_indicator"></a></h3>
<p>Pour les indicateurs personnalisés :</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"my_indicator"</span>,</span>
<span>    category <span class="op">=</span> <span class="st">"custom"</span>,</span>
<span>    fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">units</span>, <span class="va">layers</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span> <span class="va">...</span> <span class="op">}</span>,</span>
<span>    dependencies <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"layer1"</span>, <span class="st">"layer2"</span><span class="op">)</span>,</span>
<span>    description <span class="op">=</span> <span class="st">"..."</span>,</span>
<span>    params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>default_param <span class="op">=</span> <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  class <span class="op">=</span> <span class="st">"nemeton_indicator"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="id_8-dépendances">8. Dépendances<a class="anchor" aria-label="anchor" href="#id_8-d%C3%A9pendances"></a></h2>
<div class="section level3">
<h3 id="id_81-dépendances-obligatoires-imports">8.1 Dépendances obligatoires (Imports)<a class="anchor" aria-label="anchor" href="#id_81-d%C3%A9pendances-obligatoires-imports"></a></h3>
<table class="table"><thead><tr class="header"><th>Package</th>
<th>Version minimale</th>
<th>Usage</th>
</tr></thead><tbody><tr class="odd"><td><code>sf</code></td>
<td>&gt;= 1.0-0</td>
<td>Manipulation de vecteurs, classe de base</td>
</tr><tr class="even"><td><code>terra</code></td>
<td>&gt;= 1.7-0</td>
<td>Manipulation de rasters</td>
</tr><tr class="odd"><td><code>exactextractr</code></td>
<td>&gt;= 0.9.0</td>
<td>Extraction zonale performante</td>
</tr><tr class="even"><td><code>dplyr</code></td>
<td>&gt;= 1.1.0</td>
<td>Manipulation de données</td>
</tr><tr class="odd"><td><code>ggplot2</code></td>
<td>&gt;= 3.4.0</td>
<td>Visualisations</td>
</tr><tr class="even"><td><code>rlang</code></td>
<td>&gt;= 1.1.0</td>
<td>Métaprogrammation, NSE</td>
</tr><tr class="odd"><td><code>cli</code></td>
<td>&gt;= 3.6.0</td>
<td>Messages formatés</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="id_82-dépendances-suggérées-suggests">8.2 Dépendances suggérées (Suggests)<a class="anchor" aria-label="anchor" href="#id_82-d%C3%A9pendances-sugg%C3%A9r%C3%A9es-suggests"></a></h3>
<table class="table"><thead><tr class="header"><th>Package</th>
<th>Usage</th>
</tr></thead><tbody><tr class="odd"><td><code>units</code></td>
<td>Conversion d’unités (hectares, m², etc.)</td>
</tr><tr class="even"><td><code>purrr</code></td>
<td>Programmation fonctionnelle</td>
</tr><tr class="odd"><td><code>tidyr</code></td>
<td>Reshaping pour visualisations</td>
</tr><tr class="even"><td><code>scales</code></td>
<td>Formatage d’axes dans ggplot2</td>
</tr><tr class="odd"><td><code>viridis</code></td>
<td>Palettes de couleurs</td>
</tr><tr class="even"><td><code>ggradar</code></td>
<td>Diagrammes radar (ou réimplémentation)</td>
</tr><tr class="odd"><td><code>lwgeom</code></td>
<td>Opérations géométriques avancées</td>
</tr><tr class="even"><td><code>stars</code></td>
<td>Support rasters alternatif (datacubes)</td>
</tr><tr class="odd"><td><code>furrr</code></td>
<td>Calculs parallèles avec future</td>
</tr><tr class="even"><td><code>targets</code></td>
<td>Pipelines reproductibles</td>
</tr><tr class="odd"><td><code>testthat</code></td>
<td>Tests unitaires</td>
</tr><tr class="even"><td><code>knitr</code></td>
<td>Vignettes</td>
</tr><tr class="odd"><td><code>rmarkdown</code></td>
<td>Vignettes et rapports</td>
</tr><tr class="even"><td><code>covr</code></td>
<td>Couverture de code</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="id_83-dépendances-système">8.3 Dépendances système<a class="anchor" aria-label="anchor" href="#id_83-d%C3%A9pendances-syst%C3%A8me"></a></h3>
<ul><li>
<strong>GDAL</strong> &gt;= 3.0 (via sf/terra)</li>
<li>
<strong>PROJ</strong> &gt;= 6.0 (projections)</li>
<li>
<strong>GEOS</strong> &gt;= 3.8 (opérations géométriques)</li>
</ul><hr></div>
</div>
<div class="section level2">
<h2 id="id_9-stratégie-de-tests">9. Stratégie de tests<a class="anchor" aria-label="anchor" href="#id_9-strat%C3%A9gie-de-tests"></a></h2>
<div class="section level3">
<h3 id="id_91-principes">9.1 Principes<a class="anchor" aria-label="anchor" href="#id_91-principes"></a></h3>
<ul><li>
<strong>Couverture cible</strong> : &gt;= 80%</li>
<li>
<strong>Tests systématiques</strong> : toute fonction exportée doit avoir au moins un test</li>
<li>
<strong>Tests de non-régression</strong> : fixtures pour valeurs attendues</li>
<li>
<strong>Tests d’intégration</strong> : workflows complets de bout en bout</li>
</ul></div>
<div class="section level3">
<h3 id="id_92-catégories-de-tests">9.2 Catégories de tests<a class="anchor" aria-label="anchor" href="#id_92-cat%C3%A9gories-de-tests"></a></h3>
<div class="section level4">
<h4 id="tests-unitaires">Tests unitaires<a class="anchor" aria-label="anchor" href="#tests-unitaires"></a></h4>
<p><strong>Fichier</strong> : <code>tests/testthat/test-units.R</code> - Création d’unités depuis sf - Validation de géométries - Ajout/modification de métadonnées - Transformation CRS</p>
<p><strong>Fichier</strong> : <code>tests/testthat/test-layers.R</code> - Création de catalogue de couches - Validation de chemins - Chargement lazy - Harmonisation CRS</p>
<p><strong>Fichier</strong> : <code>tests/testthat/test-indicators.R</code> - Calcul de chaque indicateur individuellement - Gestion des NA - Gestion de couches manquantes - Polarité des indicateurs</p>
<p><strong>Fichier</strong> : <code>tests/testthat/test-normalization.R</code> - Normalisation min-max - Normalisation z-score - Agrégation pondérée - Indices thématiques</p>
<p><strong>Fichier</strong> : <code>tests/testthat/test-temporal.R</code> - Création de projet - Ajout/suppression d’époques - Comparaison d’états - Calcul de tendances</p>
<p><strong>Fichier</strong> : <code>tests/testthat/test-visualization.R</code> - Génération de cartes (retour ggplot valide) - Génération de radars - Timelines - Comparaisons</p>
</div>
<div class="section level4">
<h4 id="tests-dintégration">Tests d’intégration<a class="anchor" aria-label="anchor" href="#tests-dint%C3%A9gration"></a></h4>
<p><strong>Fichier</strong> : <code>tests/testthat/test-workflow.R</code></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">test_that</span><span class="op">(</span><span class="st">"workflow complet fonctionne de bout en bout"</span>, <span class="op">{</span></span>
<span>  <span class="co"># 1. Créer unités</span></span>
<span>  <span class="va">units</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_units.html">nemeton_units</a></span><span class="op">(</span><span class="va">demo_polygons</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># 2. Charger couches</span></span>
<span>  <span class="va">layers</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_layers.html">nemeton_layers</a></span><span class="op">(</span></span>
<span>    rasters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ndvi <span class="op">=</span> <span class="va">demo_ndvi_path</span><span class="op">)</span>,</span>
<span>    vectors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>hydro <span class="op">=</span> <span class="va">demo_hydro_path</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># 3. Calculer indicateurs</span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_compute.html">nemeton_compute</a></span><span class="op">(</span><span class="va">units</span>, <span class="va">layers</span>, indicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"carbon"</span>, <span class="st">"water"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># 4. Normaliser et agréger</span></span>
<span>  <span class="va">indices</span> <span class="op">&lt;-</span> <span class="fu">nemeton_index</span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># 5. Visualiser</span></span>
<span>  <span class="va">map</span> <span class="op">&lt;-</span> <span class="fu">nemeton_map</span><span class="op">(</span><span class="va">results</span>, <span class="st">"carbon"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Assertions</span></span>
<span>  <span class="fu">expect_s3_class</span><span class="op">(</span><span class="va">results</span>, <span class="st">"sf"</span><span class="op">)</span></span>
<span>  <span class="fu">expect_true</span><span class="op">(</span><span class="st">"carbon"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">expect_s3_class</span><span class="op">(</span><span class="va">map</span>, <span class="st">"ggplot"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="tests-de-données">Tests de données<a class="anchor" aria-label="anchor" href="#tests-de-donn%C3%A9es"></a></h4>
<p><strong>Fichier</strong> : <code>tests/testthat/test-data.R</code> - Validation des données d’exemple (massif_demo) - Cohérence des fixtures de test</p>
</div>
</div>
<div class="section level3">
<h3 id="id_93-fixtures-de-test">9.3 Fixtures de test<a class="anchor" aria-label="anchor" href="#id_93-fixtures-de-test"></a></h3>
<p><strong>Répertoire</strong> : <code>tests/testthat/fixtures/</code></p>
<p>Contenu : - <code>demo_units.gpkg</code> : 10 polygones de test - <code>demo_ndvi.tif</code> : raster NDVI 100x100 - <code>demo_dem.tif</code> : MNT 100x100 - <code>demo_hydro.gpkg</code> : réseau hydro fictif - <code>expected_carbon.rds</code> : valeurs attendues pour indicateur carbone</p>
</div>
<div class="section level3">
<h3 id="id_94-tests-de-régression">9.4 Tests de régression<a class="anchor" aria-label="anchor" href="#id_94-tests-de-r%C3%A9gression"></a></h3>
<p>À chaque modification d’un indicateur, vérifier que les valeurs calculées sur les fixtures ne changent pas (ou documenter pourquoi).</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">test_that</span><span class="op">(</span><span class="st">"carbon indicator gives expected values"</span>, <span class="op">{</span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/indicator_carbon.html">indicator_carbon</a></span><span class="op">(</span><span class="va">demo_units</span>, <span class="va">demo_layers</span><span class="op">)</span></span>
<span>  <span class="va">expected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"fixtures/expected_carbon.rds"</span><span class="op">)</span></span>
<span>  <span class="fu">expect_equal</span><span class="op">(</span><span class="va">results</span>, <span class="va">expected</span>, tolerance <span class="op">=</span> <span class="fl">1e-6</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_95-tests-de-performance-optionnel">9.5 Tests de performance (optionnel)<a class="anchor" aria-label="anchor" href="#id_95-tests-de-performance-optionnel"></a></h3>
<p><strong>Fichier</strong> : <code>tests/testthat/test-performance.R</code></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">test_that</span><span class="op">(</span><span class="st">"nemeton_compute scales to 1000 units"</span>, <span class="op">{</span></span>
<span>  <span class="va">large_units</span> <span class="op">&lt;-</span> <span class="fu">generate_grid</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_compute.html">nemeton_compute</a></span><span class="op">(</span><span class="va">large_units</span>, <span class="va">demo_layers</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">expect_lt</span><span class="op">(</span><span class="va">time</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span>, <span class="fl">60</span><span class="op">)</span>  <span class="co"># Moins de 60 secondes</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="id_10-documentation-et-exemples">10. Documentation et exemples<a class="anchor" aria-label="anchor" href="#id_10-documentation-et-exemples"></a></h2>
<div class="section level3">
<h3 id="id_101-readmemd">10.1 README.md<a class="anchor" aria-label="anchor" href="#id_101-readmemd"></a></h3>
<p><strong>Sections</strong> :</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu"># nemeton</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>Analyse systémique de territoires forestiers selon la méthode Néméton.</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a><span class="fu">## Installation</span></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a><span class="fu">## Démarrage rapide</span></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a><span class="fu">## Fonctionnalités principales</span></span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a><span class="fu">## Exemples</span></span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a><span class="fu">## Documentation</span></span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a><span class="fu">## Citation</span></span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a><span class="fu">## Contribution</span></span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a><span class="fu">## Licence</span></span></code></pre></div>
<p><strong>Exemple de code minimal</strong> :</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pascalobstetar/nemeton" class="external-link">nemeton</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Charger des unités</span></span>
<span><span class="va">units</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_units.html">nemeton_units</a></span><span class="op">(</span><span class="fu">st_read</span><span class="op">(</span><span class="st">"parcelles.gpkg"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Charger des couches</span></span>
<span><span class="va">layers</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_layers.html">nemeton_layers</a></span><span class="op">(</span></span>
<span>  rasters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ndvi <span class="op">=</span> <span class="st">"ndvi.tif"</span>, dem <span class="op">=</span> <span class="st">"dem.tif"</span><span class="op">)</span>,</span>
<span>  vectors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>hydro <span class="op">=</span> <span class="st">"rivers.gpkg"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculer les indicateurs</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_compute.html">nemeton_compute</a></span><span class="op">(</span><span class="va">units</span>, <span class="va">layers</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualiser</span></span>
<span><span class="fu">nemeton_map</span><span class="op">(</span><span class="va">results</span>, <span class="st">"carbon"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_102-vignettes">10.2 Vignettes<a class="anchor" aria-label="anchor" href="#id_102-vignettes"></a></h3>
<div class="section level4">
<h4 id="vignettesintro-nemetonrmd"><code>vignettes/intro-nemeton.Rmd</code><a class="anchor" aria-label="anchor" href="#vignettesintro-nemetonrmd"></a></h4>
<p><strong>Objectif</strong> : Introduction à la méthode et au package</p>
<p><strong>Contenu</strong> : - Qu’est-ce que la méthode Néméton ? - Philosophie du package - Concepts clés (unités, indicateurs, indices) - Installation et dépendances</p>
</div>
<div class="section level4">
<h4 id="vignettesworkflow-basicrmd"><code>vignettes/workflow-basic.Rmd</code><a class="anchor" aria-label="anchor" href="#vignettesworkflow-basicrmd"></a></h4>
<p><strong>Objectif</strong> : Workflow complet de A à Z</p>
<p><strong>Contenu</strong> : 1. Définir des unités d’analyse 2. Charger des couches spatiales 3. Calculer des indicateurs 4. Normaliser et agréger 5. Visualiser les résultats 6. Exporter vers QGIS</p>
<p><strong>Dataset</strong> : massif forestier fictif de 50 parcelles</p>
</div>
<div class="section level4">
<h4 id="vignettesmulti-temporalrmd"><code>vignettes/multi-temporal.Rmd</code><a class="anchor" aria-label="anchor" href="#vignettesmulti-temporalrmd"></a></h4>
<p><strong>Objectif</strong> : Analyse diachronique</p>
<p><strong>Contenu</strong> : 1. Créer un projet multi-époques 2. Ajouter des états (1950, 2020, 2050) 3. Comparer les changements 4. Visualiser les trajectoires 5. Identifier les tendances</p>
<p><strong>Dataset</strong> : évolution d’une forêt sur 100 ans</p>
</div>
<div class="section level4">
<h4 id="vignettescustom-indicatorsrmd"><code>vignettes/custom-indicators.Rmd</code><a class="anchor" aria-label="anchor" href="#vignettescustom-indicatorsrmd"></a></h4>
<p><strong>Objectif</strong> : Créer ses propres indicateurs</p>
<p><strong>Contenu</strong> : 1. Anatomie d’un indicateur 2. Écrire une fonction d’indicateur 3. Enregistrer l’indicateur 4. L’utiliser dans nemeton_compute() 5. Exemples : indicateur de maturité forestière, connectivité écologique</p>
</div>
<div class="section level4">
<h4 id="vignettesintegration-targetsrmd"><code>vignettes/integration-targets.Rmd</code><a class="anchor" aria-label="anchor" href="#vignettesintegration-targetsrmd"></a></h4>
<p><strong>Objectif</strong> : Automatisation avec {targets}</p>
<p><strong>Contenu</strong> : 1. Pourquoi targets ? 2. Structure d’un projet targets + nemeton 3. Définir un pipeline 4. Exécuter et visualiser 5. Mise à jour incrémentale</p>
<p><strong>Code</strong> :</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># _targets.R</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/targets/" class="external-link">targets</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pascalobstetar/nemeton" class="external-link">nemeton</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tar_option_set</span><span class="op">(</span>packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nemeton"</span>, <span class="st">"sf"</span>, <span class="st">"terra"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">tar_target</span><span class="op">(</span><span class="va">units</span>, <span class="fu"><a href="reference/nemeton_units.html">nemeton_units</a></span><span class="op">(</span><span class="fu">st_read</span><span class="op">(</span><span class="st">"data/parcelles.gpkg"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">tar_target</span><span class="op">(</span><span class="va">layers</span>, <span class="fu"><a href="reference/nemeton_layers.html">nemeton_layers</a></span><span class="op">(</span></span>
<span>    rasters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ndvi <span class="op">=</span> <span class="st">"data/ndvi.tif"</span><span class="op">)</span>,</span>
<span>    vectors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>hydro <span class="op">=</span> <span class="st">"data/hydro.gpkg"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">tar_target</span><span class="op">(</span><span class="va">results</span>, <span class="fu"><a href="reference/nemeton_compute.html">nemeton_compute</a></span><span class="op">(</span><span class="va">units</span>, <span class="va">layers</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">tar_target</span><span class="op">(</span><span class="va">indices</span>, <span class="fu">nemeton_index</span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">tar_target</span><span class="op">(</span><span class="va">map_carbon</span>, <span class="fu">nemeton_map</span><span class="op">(</span><span class="va">results</span>, <span class="st">"carbon"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="id_103-documentation-des-fonctions-roxygen2">10.3 Documentation des fonctions (roxygen2)<a class="anchor" aria-label="anchor" href="#id_103-documentation-des-fonctions-roxygen2"></a></h3>
<p><strong>Template standard</strong> :</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Calculer les indicateurs Néméton</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' Calcule un ensemble d'indicateurs spatiaux pour des unités forestières</span></span>
<span><span class="co">#' à partir de couches géospatiales.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param units Un objet \code{nemeton_units} ou \code{sf} représentant</span></span>
<span><span class="co">#'   les unités d'analyse.</span></span>
<span><span class="co">#' @param layers Un objet \code{nemeton_layers} contenant les couches spatiales.</span></span>
<span><span class="co">#' @param indicators Vecteur de noms d'indicateurs à calculer, ou \code{"all"}</span></span>
<span><span class="co">#'   pour tous les indicateurs disponibles.</span></span>
<span><span class="co">#' @param preprocess Logique. Si \code{TRUE}, harmonise automatiquement les CRS</span></span>
<span><span class="co">#'   et découpe les couches sur l'emprise des unités.</span></span>
<span><span class="co">#' @param parallel Logique. Si \code{TRUE}, utilise le backend \code{future}</span></span>
<span><span class="co">#'   pour le calcul parallèle.</span></span>
<span><span class="co">#' @param progress Logique. Afficher une barre de progression ?</span></span>
<span><span class="co">#' @param ... Arguments additionnels passés aux fonctions d'indicateurs.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return Un objet \code{sf} identique à \code{units} avec des colonnes</span></span>
<span><span class="co">#'   additionnelles pour chaque indicateur calculé.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @details</span></span>
<span><span class="co">#' Les indicateurs disponibles peuvent être listés avec \code{list_indicators()}.</span></span>
<span><span class="co">#' Chaque indicateur est calculé indépendamment ; les erreurs pour un indicateur</span></span>
<span><span class="co">#' spécifique génèrent un avertissement mais n'arrêtent pas le calcul des autres.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' Si \code{preprocess = TRUE}, la fonction vérifie la compatibilité des CRS</span></span>
<span><span class="co">#' entre \code{units} et chaque couche, et reprojette si nécessaire dans le CRS</span></span>
<span><span class="co">#' de \code{units}.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' \dontrun{</span></span>
<span><span class="co">#' library(nemeton)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Charger des unités</span></span>
<span><span class="co">#' units &lt;- nemeton_units(st_read("parcelles.gpkg"))</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Charger des couches</span></span>
<span><span class="co">#' layers &lt;- nemeton_layers(</span></span>
<span><span class="co">#'   rasters = list(ndvi = "ndvi.tif", dem = "dem.tif")</span></span>
<span><span class="co">#' )</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Calculer tous les indicateurs</span></span>
<span><span class="co">#' results &lt;- nemeton_compute(units, layers)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Calculer seulement certains indicateurs</span></span>
<span><span class="co">#' results &lt;- nemeton_compute(</span></span>
<span><span class="co">#'   units, layers,</span></span>
<span><span class="co">#'   indicators = c("carbon", "biodiversity", "water")</span></span>
<span><span class="co">#' )</span></span>
<span><span class="co">#' }</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @seealso</span></span>
<span><span class="co">#' \code{\link{nemeton_units}}, \code{\link{nemeton_layers}},</span></span>
<span><span class="co">#' \code{\link{list_indicators}}</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">nemeton_compute</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">units</span>, <span class="va">layers</span>, <span class="va">indicators</span> <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>                            <span class="va">preprocess</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">parallel</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                            <span class="va">progress</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Implementation</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_104-site-web-pkgdown">10.4 Site web (pkgdown)<a class="anchor" aria-label="anchor" href="#id_104-site-web-pkgdown"></a></h3>
<p><strong>Configuration</strong> : <code>_pkgdown.yml</code></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">url</span><span class="kw">:</span><span class="at"> https://yourorg.github.io/nemeton</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a><span class="at">  </span><span class="fu">bootstrap</span><span class="kw">:</span><span class="at"> </span><span class="dv">5</span></span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a><span class="fu">reference</span><span class="kw">:</span></span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"Workflow principal"</span></span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a><span class="at">    </span><span class="fu">desc</span><span class="kw">:</span><span class="at"> </span><span class="st">"Fonctions de haut niveau pour le workflow Néméton"</span></span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a><span class="at">    </span><span class="fu">contents</span><span class="kw">:</span></span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> nemeton_units</span></span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> nemeton_layers</span></span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> nemeton_compute</span></span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> nemeton_index</span></span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"Analyse temporelle"</span></span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a><span class="at">    </span><span class="fu">contents</span><span class="kw">:</span></span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> nemeton_project</span></span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> add_epoch</span></span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> nemeton_compare</span></span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"Indicateurs biophysiques"</span></span>
<span id="cb45-22"><a href="#cb45-22" tabindex="-1"></a><span class="at">    </span><span class="fu">contents</span><span class="kw">:</span></span>
<span id="cb45-23"><a href="#cb45-23" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> starts_with("indicator_carbon")</span></span>
<span id="cb45-24"><a href="#cb45-24" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> starts_with("indicator_biodiversity")</span></span>
<span id="cb45-25"><a href="#cb45-25" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> starts_with("indicator_water")</span></span>
<span id="cb45-26"><a href="#cb45-26" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"Visualisation"</span></span>
<span id="cb45-28"><a href="#cb45-28" tabindex="-1"></a><span class="at">    </span><span class="fu">contents</span><span class="kw">:</span></span>
<span id="cb45-29"><a href="#cb45-29" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> nemeton_map</span></span>
<span id="cb45-30"><a href="#cb45-30" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> nemeton_radar</span></span>
<span id="cb45-31"><a href="#cb45-31" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> nemeton_timeline</span></span>
<span id="cb45-32"><a href="#cb45-32" tabindex="-1"></a></span>
<span id="cb45-33"><a href="#cb45-33" tabindex="-1"></a><span class="fu">articles</span><span class="kw">:</span></span>
<span id="cb45-34"><a href="#cb45-34" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"Tutoriels"</span></span>
<span id="cb45-35"><a href="#cb45-35" tabindex="-1"></a><span class="at">    </span><span class="fu">contents</span><span class="kw">:</span></span>
<span id="cb45-36"><a href="#cb45-36" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> intro-nemeton</span></span>
<span id="cb45-37"><a href="#cb45-37" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> workflow-basic</span></span>
<span id="cb45-38"><a href="#cb45-38" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> multi-temporal</span></span>
<span id="cb45-39"><a href="#cb45-39" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> custom-indicators</span></span>
<span id="cb45-40"><a href="#cb45-40" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> integration-targets</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="id_11-extensibilité-et-personnalisation">11. Extensibilité et personnalisation<a class="anchor" aria-label="anchor" href="#id_11-extensibilit%C3%A9-et-personnalisation"></a></h2>
<div class="section level3">
<h3 id="id_111-système-dindicateurs-modulaire">11.1 Système d’indicateurs modulaire<a class="anchor" aria-label="anchor" href="#id_111-syst%C3%A8me-dindicateurs-modulaire"></a></h3>
<p>Les utilisateurs peuvent ajouter leurs propres indicateurs de deux façons :</p>
<div class="section level4">
<h4 id="approche-1--fonction-inline">Approche 1 : Fonction inline<a class="anchor" aria-label="anchor" href="#approche-1--fonction-inline"></a></h4>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_compute.html">nemeton_compute</a></span><span class="op">(</span></span>
<span>  units <span class="op">=</span> <span class="va">my_units</span>,</span>
<span>  layers <span class="op">=</span> <span class="va">my_layers</span>,</span>
<span>  indicators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"carbon"</span>,  <span class="co"># indicateur built-in</span></span>
<span>    custom_maturity <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">units</span>, <span class="va">layers</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Calcul personnalisé</span></span>
<span>      <span class="va">maturity_scores</span> <span class="op">&lt;-</span> <span class="va">...</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">maturity_scores</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="approche-2--enregistrement-global">Approche 2 : Enregistrement global<a class="anchor" aria-label="anchor" href="#approche-2--enregistrement-global"></a></h4>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Définir l'indicateur</span></span>
<span><span class="va">my_indicator</span> <span class="op">&lt;-</span> <span class="fu">nemeton_indicator</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"forest_maturity"</span>,</span>
<span>  category <span class="op">=</span> <span class="st">"biophysical"</span>,</span>
<span>  fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">units</span>, <span class="va">layers</span>, <span class="va">age_threshold</span> <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Extraction de l'âge depuis un raster</span></span>
<span>    <span class="va">ages</span> <span class="op">&lt;-</span> <span class="fu">exactextractr</span><span class="fu">::</span><span class="fu"><a href="https://isciences.gitlab.io/exactextractr/reference/exact_extract.html" class="external-link">exact_extract</a></span><span class="op">(</span></span>
<span>      <span class="va">layers</span><span class="op">$</span><span class="va">rasters</span><span class="op">$</span><span class="va">forest_age</span>,</span>
<span>      <span class="va">units</span>,</span>
<span>      fun <span class="op">=</span> <span class="st">"mean"</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="co"># Score de maturité</span></span>
<span>    <span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">ages</span> <span class="op">&gt;=</span> <span class="va">age_threshold</span>, <span class="fl">1</span>, <span class="va">ages</span> <span class="op">/</span> <span class="va">age_threshold</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">scores</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  dependencies <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forest_age"</span><span class="op">)</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"Indice de maturité forestière basé sur l'âge moyen"</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>age_threshold <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Enregistrer</span></span>
<span><span class="fu">register_indicator</span><span class="op">(</span><span class="va">my_indicator</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Utiliser</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_compute.html">nemeton_compute</a></span><span class="op">(</span><span class="va">units</span>, <span class="va">layers</span>, indicators <span class="op">=</span> <span class="st">"forest_maturity"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="id_112-personnalisation-des-poids">11.2 Personnalisation des poids<a class="anchor" aria-label="anchor" href="#id_112-personnalisation-des-poids"></a></h3>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Définir des poids custom</span></span>
<span><span class="va">my_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  carbon <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  biodiversity <span class="op">=</span> <span class="fl">0.30</span>,</span>
<span>  water <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>  soil <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>  landscape <span class="op">=</span> <span class="fl">0.10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculer l'indice</span></span>
<span><span class="va">indices</span> <span class="op">&lt;-</span> <span class="fu">nemeton_index</span><span class="op">(</span><span class="va">results</span>, weights <span class="op">=</span> <span class="va">my_weights</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ou par groupes thématiques</span></span>
<span><span class="va">thematic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  ecological <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"biodiversity"</span>, <span class="st">"water"</span>, <span class="st">"soil"</span><span class="op">)</span>,</span>
<span>  climate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"carbon"</span>, <span class="st">"climate_risk"</span><span class="op">)</span>,</span>
<span>  social <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"accessibility"</span>, <span class="st">"heritage"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">indices</span> <span class="op">&lt;-</span> <span class="fu">nemeton_index</span><span class="op">(</span><span class="va">results</span>, thematic_groups <span class="op">=</span> <span class="va">thematic</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_113-personnalisation-des-visualisations">11.3 Personnalisation des visualisations<a class="anchor" aria-label="anchor" href="#id_113-personnalisation-des-visualisations"></a></h3>
<p>Toutes les fonctions de visualisation retournent des objets <code>ggplot</code>, personnalisables :</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Carte de base</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">nemeton_map</span><span class="op">(</span><span class="va">results</span>, <span class="st">"carbon"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Personnalisation</span></span>
<span><span class="va">p</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_c</span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, name <span class="op">=</span> <span class="st">"Stock de carbone\n(t/ha)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Stock de carbone - Forêt de Fontainebleau"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Année 2024"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_114-hooks-et-callbacks">11.4 Hooks et callbacks<a class="anchor" aria-label="anchor" href="#id_114-hooks-et-callbacks"></a></h3>
<p>Possibilité d’ajouter des hooks à certaines étapes (avancé) :</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Hook exécuté après calcul de chaque indicateur</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>nemeton.post_indicator_hook <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">indicator_name</span>, <span class="va">values</span>, <span class="va">units</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Calculé : "</span>, <span class="va">indicator_name</span>, <span class="st">" | Moyenne : "</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">values</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nemeton_compute.html">nemeton_compute</a></span><span class="op">(</span><span class="va">units</span>, <span class="va">layers</span><span class="op">)</span></span>
<span><span class="co"># → affiche les moyennes au fur et à mesure</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="id_12-feuille-de-route">12. Feuille de route<a class="anchor" aria-label="anchor" href="#id_12-feuille-de-route"></a></h2>
<div class="section level3">
<h3 id="id_121-version-010-mvp---3-mois">12.1 Version 0.1.0 (MVP - 3 mois)<a class="anchor" aria-label="anchor" href="#id_121-version-010-mvp---3-mois"></a></h3>
<p><strong>Objectif</strong> : Package fonctionnel minimal</p>
<ul class="task-list"><li><label><input type="checkbox" checked>Structure du package</label></li>
<li><label><input type="checkbox">Module <code>data-units</code> : création et validation</label></li>
<li><label><input type="checkbox">Module <code>data-layers</code> : chargement et catalogage</label></li>
<li><label><input type="checkbox">Module <code>data-preprocessing</code> : harmonisation basique</label></li>
<li>
<label><input type="checkbox">5 indicateurs biophysiques essentiels :</label>
<ul><li><code><a href="reference/indicator_carbon.html">indicator_carbon()</a></code></li>
<li><code><a href="reference/indicator_biodiversity.html">indicator_biodiversity()</a></code></li>
<li><code><a href="reference/indicator_water.html">indicator_water()</a></code></li>
<li><code><a href="reference/indicator_fragmentation.html">indicator_fragmentation()</a></code></li>
<li><code><a href="reference/indicator_accessibility.html">indicator_accessibility()</a></code></li>
</ul></li>
<li><label><input type="checkbox">Fonction <code><a href="reference/nemeton_compute.html">nemeton_compute()</a></code> complète</label></li>
<li><label><input type="checkbox">Normalisation et indices (<code>nemeton_index()</code>)</label></li>
<li>
<label><input type="checkbox">2 visualisations de base :</label>
<ul><li><code>nemeton_map()</code></li>
<li><code><a href="reference/nemeton_radar.html">nemeton_radar()</a></code></li>
</ul></li>
<li><label><input type="checkbox">Documentation complète (README, 1 vignette intro)</label></li>
<li><label><input type="checkbox">Tests unitaires (couverture &gt;= 70%)</label></li>
<li><label><input type="checkbox">Dataset d’exemple <code>massif_demo</code></label></li>
</ul><p><strong>Livrables</strong> : - Package installable depuis GitHub - Documentation pkgdown - 1 article de blog d’introduction</p>
<hr></div>
<div class="section level3">
<h3 id="id_122-version-020-multi-temporel---2-mois">12.2 Version 0.2.0 (Multi-temporel - 2 mois)<a class="anchor" aria-label="anchor" href="#id_122-version-020-multi-temporel---2-mois"></a></h3>
<p><strong>Objectif</strong> : Support de l’analyse diachronique</p>
<ul class="task-list"><li><label><input type="checkbox">Classe <code>nemeton_project</code></label></li>
<li><label><input type="checkbox">Fonction <code>add_epoch()</code></label></li>
<li><label><input type="checkbox">Fonction <code>nemeton_compare()</code></label></li>
<li>
<label><input type="checkbox">Visualisations temporelles :</label>
<ul><li><code>nemeton_timeline()</code></li>
<li><code>nemeton_radar_compare()</code></li>
</ul></li>
<li><label><input type="checkbox">Vignette “Analyse multi-temporelle”</label></li>
<li><label><input type="checkbox">Tests d’intégration temporels</label></li>
</ul><p><strong>Livrables</strong> : - Package v0.2.0 sur GitHub - Article : “Suivre l’évolution de votre forêt avec nemeton”</p>
<hr></div>
<div class="section level3">
<h3 id="id_123-version-030-extensibilité---2-mois">12.3 Version 0.3.0 (Extensibilité - 2 mois)<a class="anchor" aria-label="anchor" href="#id_123-version-030-extensibilit%C3%A9---2-mois"></a></h3>
<p><strong>Objectif</strong> : Personnalisation avancée</p>
<ul class="task-list"><li><label><input type="checkbox">Système <code>nemeton_indicator()</code> formalisé</label></li>
<li><label><input type="checkbox"><code>register_indicator()</code> global</label></li>
<li><label><input type="checkbox">5 indicateurs additionnels (paysage, social)</label></li>
<li><label><input type="checkbox">Support de fonctions custom inline</label></li>
<li><label><input type="checkbox">Vignette “Créer vos indicateurs”</label></li>
<li><label><input type="checkbox">Export vers formats multiples (GeoPackage, GeoJSON, shapefile)</label></li>
</ul><p><strong>Livrables</strong> : - Package v0.3.0 - Tutoriel vidéo : “Ajouter un indicateur personnalisé”</p>
<hr></div>
<div class="section level3">
<h3 id="id_124-version-040-performance---1-mois">12.4 Version 0.4.0 (Performance - 1 mois)<a class="anchor" aria-label="anchor" href="#id_124-version-040-performance---1-mois"></a></h3>
<p><strong>Objectif</strong> : Optimisation pour grands territoires</p>
<ul class="task-list"><li><label><input type="checkbox">Support calcul parallèle (<code>future</code> backend)</label></li>
<li><label><input type="checkbox">Chunking pour rasters volumineux</label></li>
<li><label><input type="checkbox">Optimisation mémoire (chargement lazy avancé)</label></li>
<li><label><input type="checkbox">Benchmarks et profiling</label></li>
<li><label><input type="checkbox">Tests de performance (1000+ unités)</label></li>
</ul><p><strong>Livrables</strong> : - Package v0.4.0 - Rapport de performance</p>
<hr></div>
<div class="section level3">
<h3 id="id_125-version-050-intégrations---2-mois">12.5 Version 0.5.0 (Intégrations - 2 mois)<a class="anchor" aria-label="anchor" href="#id_125-version-050-int%C3%A9grations---2-mois"></a></h3>
<p><strong>Objectif</strong> : Écosystème étendu</p>
<ul class="task-list"><li><label><input type="checkbox">Support API externes (Copernicus, IGN)</label></li>
<li><label><input type="checkbox">Intégration targets (vignette dédiée)</label></li>
<li><label><input type="checkbox">Export rapports HTML/PDF (Rmarkdown templates)</label></li>
<li><label><input type="checkbox">Interface Shiny exploratoire (package séparé ou module)</label></li>
</ul><p><strong>Livrables</strong> : - Package v0.5.0 - Application Shiny de démonstration</p>
<hr></div>
<div class="section level3">
<h3 id="id_126-version-100-stable---3-mois">12.6 Version 1.0.0 (Stable - 3 mois)<a class="anchor" aria-label="anchor" href="#id_126-version-100-stable---3-mois"></a></h3>
<p><strong>Objectif</strong> : Publication CRAN</p>
<ul class="task-list"><li><label><input type="checkbox">Refactoring API (stabilisation)</label></li>
<li><label><input type="checkbox">Documentation exhaustive</label></li>
<li><label><input type="checkbox">Vignettes complètes (5 minimum)</label></li>
<li><label><input type="checkbox">Tests complets (couverture &gt;= 90%)</label></li>
<li><label><input type="checkbox">Revue externe de code</label></li>
<li><label><input type="checkbox">Soumission CRAN</label></li>
</ul><p><strong>Livrables</strong> : - Package sur CRAN - Article scientifique (Journal of Open Source Software) - Site web complet</p>
<hr></div>
<div class="section level3">
<h3 id="id_127-post-10-évolutions-futures">12.7 Post-1.0 (Évolutions futures)<a class="anchor" aria-label="anchor" href="#id_127-post-10-%C3%A9volutions-futures"></a></h3>
<p><strong>Idées</strong> : - Support rasters cloud-optimized (COG) - Intégration avec Earth Engine (rgee) - Module d’optimisation (scénarios de gestion) - Support 3D (lidar, canopy height) - API REST pour calculs à la demande - Package Python (port ou binding)</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="annexes">Annexes<a class="anchor" aria-label="anchor" href="#annexes"></a></h2>
<div class="section level3">
<h3 id="a-conventions-de-nommage">A. Conventions de nommage<a class="anchor" aria-label="anchor" href="#a-conventions-de-nommage"></a></h3>
<p><strong>Fonctions exportées</strong> : - Préfixe <code>nemeton_</code> pour fonctions principales - Préfixe <code>indicator_</code> pour indicateurs - Verbes à l’infinitif : <code>compute</code>, <code>normalize</code>, <code>compare</code></p>
<p><strong>Arguments</strong> : - <code>snake_case</code> - Noms explicites : <code>normalize_method</code> plutôt que <code>method</code></p>
<p><strong>Objets S3</strong> : - <code>nemeton_units</code>, <code>nemeton_layers</code>, <code>nemeton_project</code></p>
<p><strong>Fichiers</strong> : - <code>nom-module.R</code> (tirets) - <code>test-nom-module.R</code> pour tests</p>
</div>
<div class="section level3">
<h3 id="b-style-de-code">B. Style de code<a class="anchor" aria-label="anchor" href="#b-style-de-code"></a></h3>
<ul><li>
<strong>Linter</strong> : <code>lintr::lint_package()</code>
</li>
<li>
<strong>Formatter</strong> : <code>styler::style_pkg()</code>
</li>
<li>
<strong>Guide</strong> : Tidyverse style guide</li>
<li>
<strong>Longueur de ligne</strong> : &lt;= 80 caractères</li>
<li>
<strong>Indentation</strong> : 2 espaces</li>
</ul></div>
<div class="section level3">
<h3 id="c-workflow-de-contribution">C. Workflow de contribution<a class="anchor" aria-label="anchor" href="#c-workflow-de-contribution"></a></h3>
<ol style="list-style-type: decimal"><li>Fork + branche feature</li>
<li>Développement + tests</li>
<li>
<code>devtools::check()</code> sans erreurs ni warnings</li>
<li>Pull request avec description claire</li>
<li>Revue de code</li>
<li>Merge après approbation</li>
</ol></div>
<div class="section level3">
<h3 id="d-ressources-externes">D. Ressources externes<a class="anchor" aria-label="anchor" href="#d-ressources-externes"></a></h3>
<p><strong>Données open data recommandées</strong> : - IGN (France) : BD Forêt, MNT, orthophotos - Copernicus : Sentinel-2 (NDVI), Corine Land Cover - OpenStreetMap : routes, sentiers, POI - Natura 2000 : zones protégées - INPN : biodiversité</p>
<p><strong>Packages R inspirants</strong> : - <code>landscapemetrics</code> : métriques paysagères - <code>biodivMapR</code> : cartographie de biodiversité - <code>rgugik</code> : accès données polonaises (modèle pour API) - <code>rstac</code> : accès STAC pour imagerie satellite</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="changelog">Changelog<a class="anchor" aria-label="anchor" href="#changelog"></a></h2>
<div class="section level3">
<h3 id="version-100-2026-01-04">Version 1.0.0 (2026-01-04)<a class="anchor" aria-label="anchor" href="#version-100-2026-01-04"></a></h3>
<ul><li>Spécification initiale complète</li>
<li>Architecture du package définie</li>
<li>API et modules décrits</li>
<li>Feuille de route établie</li>
</ul><hr><p><strong>Fin de la spécification technique</strong></p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/pobsteta" class="external-link">Pascal Obstétar</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

