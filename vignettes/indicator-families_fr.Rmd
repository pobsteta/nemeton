---
title: "Guide de r√©f√©rence des familles d'indicateurs"
author: "Pascal Obst√©tar"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Guide de r√©f√©rence des familles d'indicateurs}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 8,
  fig.height = 6,
  warning = FALSE,
  message = FALSE
)
```

> üåç **English version**: See `vignette("indicator-families")` | **Version fran√ßaise** : Ce document

# Introduction

Le package `nemeton` impl√©mente un **cadre d'indicateurs multi-famille** pour l'√©valuation des √©cosyst√®mes forestiers, bas√© sur la **m√©thode Nemeton** d√©velopp√©e par *Vivre en For√™t*. Ce cadre organise les services √©cosyst√©miques en **12 familles distinctes**, chacune repr√©sentant une dimension cl√© du fonctionnement forestier.

## Les 12 familles

```{r echo = FALSE, results = 'asis', eval = FALSE}
families <- data.frame(
  Code = c("C", "B", "W", "A", "F", "L", "T", "R", "S", "P", "E", "N"),
  Famille = c(
    "Carbone/Vitalit√©",
    "Biodiversit√©",
    "Eau",
    "Air/Microclimat",
    "Fertilit√© des sols",
    "Paysage",
    "Temps/Dynamiques",
    "R√©silience/Risques",
    "Social/Usages",
    "Productif",
    "√ânergie/Climat",
    "Naturalit√©"
  ),
  Statut_v0.2.0 = c(
    "‚úÖ Impl√©ment√© (C1, C2)",
    "‚è≥ v0.3.0+",
    "‚úÖ Impl√©ment√© (W1, W2, W3)",
    "‚è≥ v0.3.0+",
    "‚úÖ Impl√©ment√© (F1, F2)",
    "‚úÖ Partiel (L1, L2)",
    "‚è≥ v0.3.0+",
    "‚è≥ v0.3.0+",
    "‚è≥ v0.4.0+",
    "‚è≥ v0.4.0+",
    "‚è≥ v0.4.0+",
    "‚è≥ v0.3.0+"
  ),
  stringsAsFactors = FALSE
)

knitr::kable(families, caption = "Vue d'ensemble des 12 familles d'indicateurs")
```

**Version 0.2.0** impl√©mente **5 familles** avec **10 sous-indicateurs**, fournissant une base solide pour l'analyse multi-dimensionnelle.

# Installation

```{r, eval = FALSE}
# Depuis GitHub
remotes::install_github("pobsteta/nemeton")
```

```{r, eval = FALSE}
library(nemeton)
library(ggplot2)
library(dplyr)
```

## Vue d'ensemble visuelle : Le cadre 12 familles

Le graphique radar ci-dessous illustre le cadre multi-dimensionnel complet, montrant comment les 12 familles se combinent pour fournir une √©valuation holistique des services √©cosyst√©miques forestiers.

```{r fig.cap = "Graphique radar 12 familles - Cadre Nemeton complet", fig.width = 8, fig.height = 8, eval = FALSE}
# Charger les donn√©es de d√©mo
data(massif_demo_units)

# Cr√©er des scores de famille pour d√©monstration (√©chelle 0-100)
# En pratique, ces scores seraient calcul√©s √† partir d'indicateurs r√©els
demo_unit <- massif_demo_units[1, ]

# Simuler des scores de famille pour les 12 familles
# Valeurs plus √©lev√©es = meilleure performance dans cette dimension
demo_unit$family_C <- 75  # Carbone/Vitalit√© - Bon stockage de carbone
demo_unit$family_B <- 65  # Biodiversit√© - Richesse sp√©cifique mod√©r√©e
demo_unit$family_W <- 82  # Eau - Excellente r√©gulation hydrique
demo_unit$family_A <- 70  # Air/Microclimat - Bonne qualit√© de l'air
demo_unit$family_F <- 68  # Fertilit√© des sols - Fertilit√© mod√©r√©e
demo_unit$family_L <- 55  # Paysage - Fragmentation mod√©r√©e
demo_unit$family_T <- 78  # Temps/Dynamique - Caract√©ristiques de vieille for√™t
demo_unit$family_R <- 60  # R√©silience/Risques - Risque climatique mod√©r√©
demo_unit$family_S <- 85  # Social/Usages - Forte valeur r√©cr√©ative
demo_unit$family_P <- 72  # Productif - Bon potentiel de bois d'≈ìuvre
demo_unit$family_E <- 80  # √ânergie/Climat - Forte s√©questration carbone
demo_unit$family_N <- 62  # Naturalit√© - Naturalit√© mod√©r√©e

# Cr√©er le graphique radar 12 familles
nemeton_radar(
  demo_unit,
  mode = "family",
  indicators = c("family_C", "family_B", "family_W", "family_A",
                 "family_F", "family_L", "family_T", "family_R",
                 "family_S", "family_P", "family_E", "family_N"),
  normalize = FALSE,  # D√©j√† sur √©chelle 0-100
  title = "Profil √©cosyst√©mique complet 12 familles",
  fill_color = "#2E7D32",
  fill_alpha = 0.25
)
```

**Interpr√©tation** : Cette parcelle d'exemple montre :

- **Forces** (> 75) : Valeur sociale (S), R√©gulation de l'eau (W), √ânergie/Climat (E), Temps/Dynamiques (T)
- **Bonnes performances** (65-75) : Carbone (C), Air (A), Productif (P), Biodiversit√© (B)
- **Axes d'am√©lioration** (< 65) : Naturalit√© (N), R√©silience (R), Paysage (L)

Le graphique radar r√©v√®le les **compromis multi-dimensionnels** inh√©rents √† la gestion foresti√®re : une forte productivit√© (P) et valeur sociale (S) peuvent se faire au d√©triment de la naturalit√© (N) et de l'int√©grit√© du paysage (L).

# Familles impl√©ment√©es (v0.2.0)

## Famille C : Carbone & Vitalit√©

La **famille Carbone** quantifie le stockage de carbone et la vitalit√© de la v√©g√©tation.

### C1 : Stock de biomasse (indicator_carbon_biomass)

Estime la biomasse a√©rienne en utilisant des **mod√®les allom√©triques** √† partir des donn√©es BD For√™t v2.

```{r eval = FALSE}
# N√©cessite BD For√™t v2 avec esp√®ce, √¢ge, densit√©
carbon_biomass <- nemeton_compute(
  massif_demo_units,
  layers,
  indicators = "C1"
)
```

**Formule** : Biomasse (Mg/ha) via √©quations allom√©triques sp√©cifiques √† l'essence

### C2 : Vitalit√© de la v√©g√©tation (indicator_carbon_ndvi)

Extrait le NDVI moyen √† partir d'images Sentinel-2.

```{r eval = FALSE}
# N√©cessite raster NDVI (Sentinel-2)
carbon_ndvi <- nemeton_compute(
  massif_demo_units,
  layers,
  indicators = "C2"
)
```

**Interpr√©tation** : NDVI √©lev√© = v√©g√©tation vigoureuse et saine

## Famille W : R√©gulation de l'eau

La **famille Eau** √©value la capacit√© de r√©gulation hydrique.

### W1 : Densit√© du r√©seau hydrographique

```{r eval = FALSE}
water_network <- nemeton_compute(
  massif_demo_units,
  layers,
  indicators = "W1"
)
```

**Formule** : Longueur totale des cours d'eau / surface de la parcelle (km/ha)

### W2 : Couverture en zones humides

```{r eval = FALSE}
water_wetlands <- nemeton_compute(
  massif_demo_units,
  layers,
  indicators = "W2"
)
```

**Formule** : % de surface class√©e en zone humide ou ripisylve

### W3 : Indice d'humidit√© topographique (TWI)

```{r eval = FALSE}
water_twi <- nemeton_compute(
  massif_demo_units,
  layers,
  indicators = "W3"
)
```

**Formule** : TWI = ln(accumulation de flux / tan(pente))

## Famille F : Fertilit√© des sols

### F1 : Fertilit√© du sol

```{r eval = FALSE}
soil_fertility <- nemeton_compute(
  massif_demo_units,
  layers,
  indicators = "F1"
)
```

**Source** : Classes de fertilit√© de la BD Sol (r√©serve utile, texture)

### F2 : Risque d'√©rosion

```{r eval = FALSE}
soil_erosion <- nemeton_compute(
  massif_demo_units,
  layers,
  indicators = "F2"
)
```

**Formule** : Combinaison pente √ó couverture protectrice

## Famille L : Qualit√© du paysage

### L1 : Fragmentation foresti√®re

```{r eval = FALSE}
landscape_frag <- nemeton_compute(
  massif_demo_units,
  layers,
  indicators = "L1"
)
```

**Formule** : Nombre de taches / taille moyenne des taches (dans un buffer 1km)

### L2 : Ratio lisi√®re/surface

```{r eval = FALSE}
landscape_edge <- nemeton_compute(
  massif_demo_units,
  layers,
  indicators = "L2"
)
```

**Formule** : P√©rim√®tre / surface (m/ha)

# Workflows multi-familles

## Calculer plusieurs familles

```{r eval = FALSE}
# Charger les donn√©es
data(massif_demo_units)
layers <- massif_demo_layers()

# Calculer des indicateurs de 4 familles (C, W, F, L)
results <- nemeton_compute(
  massif_demo_units,
  layers,
  indicators = c("C1", "C2", "W1", "W2", "W3", "F1", "F2", "L1", "L2")
)
```

## Cr√©er des indices par famille

```{r eval = FALSE}
# Cr√©er des scores composites par famille
family_scores <- create_family_index(
  results,
  method = "mean"  # Moyenne simple
)

# Avec pond√©ration personnalis√©e
family_scores_weighted <- create_family_index(
  results,
  method = "weighted",
  weights = list(
    C = c(C1 = 0.6, C2 = 0.4),  # Carbone: 60% biomasse, 40% NDVI
    W = c(W1 = 0.5, W2 = 0.3, W3 = 0.2)  # Eau: 50% r√©seau, 30% zones humides, 20% TWI
  )
)

# V√©rifier les scores de famille
head(family_scores[, c("parcel_id", "family_C", "family_W", "family_F", "family_L")])
```

## Visualiser les profils multi-familles

```{r eval = FALSE}
# Graphique radar pour une parcelle
nemeton_radar(
  family_scores,
  unit_id = "P01",
  mode = "family",
  title = "Profil multi-famille - Parcelle P01"
)

# Comparer deux parcelles
nemeton_radar(
  family_scores[family_scores$parcel_id %in% c("P01", "P10"), ],
  mode = "family",
  title = "Comparaison de profils √©cosyst√©miques"
)
```

# Roadmap : Familles futures

## v0.3.0 - Extension Biodiversit√© & Risques

- **B1** : Zones de protection (ZNIEFF, RNR)
- **B2** : Diversit√© structurelle (strates v√©g√©tales)
- **B3** : Connectivit√© √©cologique
- **R1** : Risque incendie
- **R2** : Risque temp√™te
- **R3** : Risque s√©cheresse
- **T1** : Anciennet√© foresti√®re
- **T2** : Changements d'occupation du sol
- **N1-N3** : Indices de naturalit√©

## v0.4.0 - Extension socio-√©conomique

- **S1-S3** : Sentiers, accessibilit√©, proximit√© population
- **P1-P3** : Volume, productivit√©, qualit√© bois
- **A1-A2** : Couverture arbor√©e, qualit√© de l'air

## v0.5.0 - Cadre complet

- **E1-E2** : Bois-√©nergie, √©vitement carbone
- Tous les 36 sous-indicateurs (12 familles √ó 3 sous-indicateurs moyens)
- Dashboard Shiny interactif
- Analyse d'incertitude

# Tableaux de r√©f√©rence

## Conventions de nommage des indicateurs

| Pr√©fixe | Famille | Exemple |
|---------|---------|---------|
| C | Carbone/Vitalit√© | C1, C2 |
| B | Biodiversit√© | B1, B2, B3 |
| W | Eau | W1, W2, W3 |
| A | Air/Microclimat | A1, A2 |
| F | Fertilit√© sols | F1, F2 |
| L | Paysage | L1, L2, L3 |
| T | Temps/Dynamique | T1, T2 |
| R | R√©silience/Risques | R1, R2, R3 |
| S | Social/Usages | S1, S2, S3 |
| P | Productif/√âconomie | P1, P2, P3 |
| E | √ânergie/Climat | E1, E2 |
| N | Naturalit√© | N1, N2, N3 |

## Codes de famille

```{r echo = FALSE, results = 'asis', eval = FALSE}
family_codes <- data.frame(
  Code = c("C", "B", "W", "A", "F", "L", "T", "R", "S", "P", "E", "N"),
  Nom_FR = c(
    "Carbone/√ânerg√©tique",
    "Biodiversit√©/Vivant",
    "Eau/Infiltr√©e",
    "Air/Vaporeuse",
    "Fertilit√©/Riche",
    "Paysage/Esth√©tique",
    "Trame/Nervur√©e",
    "R√©silience/Flexible",
    "Sant√©/Ouverte",
    "Patrimoine/Radicale",
    "√âducation/√âducative",
    "Nuit/T√©n√©breuse"
  ),
  Nom_EN = c(
    "Carbon/Vitality",
    "Biodiversity",
    "Water",
    "Air/Microclimate",
    "Soil Fertility",
    "Landscape",
    "Time/Dynamics",
    "Resilience/Risks",
    "Social/Uses",
    "Productive",
    "Energy/Climate",
    "Naturalness"
  ),
  stringsAsFactors = FALSE
)

knitr::kable(family_codes, caption = "Codes des familles d'indicateurs")
```

# R√©sum√©

Le workflow d'analyse multi-famille `nemeton` permet :

1. **Gestion multi-famille** : Calcul d'indicateurs organis√©s en 12 familles
2. **Agr√©gation flexible** : Cr√©ation d'indices composites par famille
3. **Visualisation radar** : Graphiques multi-axes pour comparaison
4. **√âvaluation holistique** : Vision syst√©mique des √©cosyst√®mes forestiers
5. **Extensibilit√©** : Framework pour ajout de nouvelles familles

## Fonctions cl√©s

- `nemeton_compute()` : Calcul des indicateurs
- `create_family_index()` : Agr√©gation par famille
- `nemeton_radar()` : Visualisation multi-famille
- `normalize_indicators()` : Normalisation avec pr√©fixes famille

## Prochaines √©tapes

- Explorer l'analyse temporelle : `vignette("temporal-analysis_fr")`
- Apprendre le workflow de base : `vignette("getting-started_fr")`
- Consulter la documentation : `help(package = "nemeton")`

# Session Info

```{r, eval = FALSE}
sessionInfo()
```
